<hr>
<p>title: kubectl node<br>date: 2018-10-03 11:13:06<br>tags: </p>
<ul>
<li>kubectl</li>
<li>Kubernetes</li>
<li>Command</li>
<li>Node<br>categories:</li>
<li>Kubernetes</li>
<li>Command</li>
</ul>
<hr>
<h3 id="Pod"><a href="#Pod" class="headerlink" title="Pod"></a>Pod</h3><h4 id="Force-delete"><a href="#Force-delete" class="headerlink" title="Force delete"></a>Force delete</h4><pre><code class="bash">kubectl delete pods pod-name  --grace-period=0 --force
</code></pre>
<p>If even after these commands the pod is stuck on Unknown state, use the following command to remove the pod from the cluster:</p>
<pre><code class="bash">kubectl patch pod &lt;pod&gt; -p <span class="string">'{"metadata":{"finalizers":null}}'</span>
</code></pre>
<h4 id="Running-with-Shell"><a href="#Running-with-Shell" class="headerlink" title="Running with Shell"></a>Running with Shell</h4><pre><code class="bash">kubectl run pod-name -i --rm --image nginx:lastes -- sh -c
</code></pre>
<pre><code class="bash">Examples:
  <span class="comment"># Start a single instance of nginx.</span>
  kubectl run nginx --image=nginx

  <span class="comment"># Start a single instance of hazelcast and let the container expose port 5701 .</span>
  kubectl run hazelcast --image=hazelcast --port=5701

  <span class="comment"># Start a single instance of hazelcast and set environment variables "DNS_DOMAIN=cluster" and "POD_NAMESPACE=default" in the container.</span>
  kubectl run hazelcast --image=hazelcast --env=<span class="string">"DNS_DOMAIN=cluster"</span> --env=<span class="string">"POD_NAMESPACE=default"</span>

  <span class="comment"># Start a single instance of hazelcast and set labels "app=hazelcast" and "env=prod" in the container.</span>
  kubectl run hazelcast --image=nginx --labels=<span class="string">"app=hazelcast,env=prod"</span>

  <span class="comment"># Start a replicated instance of nginx.</span>
  kubectl run nginx --image=nginx --replicas=5

  <span class="comment"># Dry run. Print the corresponding API objects without creating them.</span>
  kubectl run nginx --image=nginx --dry-run

  <span class="comment"># Start a single instance of nginx, but overload the spec of the deployment with a partial set of values parsed from JSON.</span>
  kubectl run nginx --image=nginx --overrides=<span class="string">'{ "apiVersion": "v1", "spec": { ... } }'</span>

  <span class="comment"># Start a pod of busybox and keep it in the foreground, don't restart it if it exits.</span>
  kubectl run -i -t busybox --image=busybox --restart=Never

  <span class="comment"># Start the nginx container using the default command, but use custom arguments (arg1 .. argN) for that command.</span>
  kubectl run nginx --image=nginx -- &lt;arg1&gt; &lt;arg2&gt; ... &lt;argN&gt;

  <span class="comment"># Start the nginx container using a different command and custom arguments.</span>
  kubectl run nginx --image=nginx --<span class="built_in">command</span> -- &lt;cmd&gt; &lt;arg1&gt; ... &lt;argN&gt;

  <span class="comment"># Start the perl container to compute π to 2000 places and print it out.</span>
  kubectl run pi --image=perl --restart=OnFailure -- perl -Mbignum=bpi -wle <span class="string">'print bpi(2000)'</span>

  <span class="comment"># Start the cron job to compute π to 2000 places and print it out every 5 minutes.</span>
  kubectl run pi --schedule=<span class="string">"0/5 * * * ?"</span> --image=perl --restart=OnFailure -- perl -Mbignum=bpi -wle <span class="string">'print bpi(2000)'</span>
</code></pre>
<h3 id="Label"><a href="#Label" class="headerlink" title="Label"></a>Label</h3><h4 id="Add-label-to-node"><a href="#Add-label-to-node" class="headerlink" title="Add label to node"></a>Add label to node</h4><pre><code class="bash">kubectl label nodes &lt;node-name&gt; &lt;label-key&gt;=&lt;label-value&gt;
</code></pre>
<p>example：</p>
<pre><code class="bash">kubectl label nodes gke-xxx-cc361276-cvfg node=elasticsearch
</code></pre>
<h4 id="Adding-or-updating-labels-for-existing-clusters"><a href="#Adding-or-updating-labels-for-existing-clusters" class="headerlink" title="Adding or updating labels for existing clusters"></a>Adding or updating labels for existing clusters</h4><pre><code class="bash">gcloud container clusters update [CLUSTER_NAME] --update-labels [KEY]=[VALUE]
</code></pre>
<h4 id="Remove-labels-for-existing-clusters"><a href="#Remove-labels-for-existing-clusters" class="headerlink" title="Remove labels for existing clusters"></a>Remove labels for existing clusters</h4><pre><code class="bash">gcloud container clusters update example-cluster --remove-labels env=dev
</code></pre>
