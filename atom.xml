<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>A Big Boy Blog -  Tech Articls &amp; Notes</title>
  
  <subtitle>Python Java Android Django Web -&gt; sulang357159@gmail.com</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://sulangsss.github.io/"/>
  <updated>2019-09-08T04:16:42.283Z</updated>
  <id>https://sulangsss.github.io/</id>
  
  <author>
    <name>Jason - sulang357159@163.com</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Aeron Core Configurations</title>
    <link href="https://sulangsss.github.io/2019/09/08/Java/LowLatency/Aeron-Configuration/"/>
    <id>https://sulangsss.github.io/2019/09/08/Java/LowLatency/Aeron-Configuration/</id>
    <published>2019-09-08T04:01:22.000Z</published>
    <updated>2019-09-08T04:16:42.283Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Network"><a href="#Network" class="headerlink" title="Network"></a>Network</h3><h4 id="MTU"><a href="#MTU" class="headerlink" title="MTU"></a>MTU</h4><p>aeron.mtu.length on the Media Driver controls the length of the MTU of data frames. This value is communicated to the Aeron clients during registration. So, applications do not have to concern themselves with the MTU value used by the Media Driver and use the same value.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Network&quot;&gt;&lt;a href=&quot;#Network&quot; class=&quot;headerlink&quot; title=&quot;Network&quot;&gt;&lt;/a&gt;Network&lt;/h3&gt;&lt;h4 id=&quot;MTU&quot;&gt;&lt;a href=&quot;#MTU&quot; class=&quot;headerlink&quot; title=
      
    
    </summary>
    
      <category term="Java" scheme="https://sulangsss.github.io/categories/Java/"/>
    
      <category term="Low Latency" scheme="https://sulangsss.github.io/categories/Java/Low-Latency/"/>
    
    
      <category term="Java" scheme="https://sulangsss.github.io/tags/Java/"/>
    
      <category term="Low Latency" scheme="https://sulangsss.github.io/tags/Low-Latency/"/>
    
      <category term="Aeron" scheme="https://sulangsss.github.io/tags/Aeron/"/>
    
      <category term="Cofiguration" scheme="https://sulangsss.github.io/tags/Cofiguration/"/>
    
  </entry>
  
  <entry>
    <title>UDP - Message too long</title>
    <link href="https://sulangsss.github.io/2019/09/07/Network/UDP/Message-too-long/"/>
    <id>https://sulangsss.github.io/2019/09/07/Network/UDP/Message-too-long/</id>
    <published>2019-09-07T06:57:00.000Z</published>
    <updated>2019-09-07T10:01:13.489Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Cause"><a href="#Cause" class="headerlink" title="Cause"></a>Cause</h3><hr><h3 id="Practice"><a href="#Practice" class="headerlink" title="Practice"></a>Practice</h3><p>Use ICMP pacakge to find out best MTU value</p><blockquote><p>IP pacakge header occupy 20 bytes, ICMP package header occupy 8 bytes.</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Linux</span></span><br><span class="line"><span class="comment"># google.com 216.58.204.110</span></span><br><span class="line"><span class="comment"># ping -c (number) -M do -s (bytes) IP</span></span><br><span class="line">ping -c 1 -M <span class="keyword">do</span> -s 1470 216.58.204.110</span><br><span class="line"><span class="comment"># or ping -c 1 -M do -s 1472 216.58.204.110</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># regular output</span></span><br><span class="line">--- 216.58.204.110 ping statistics ---</span><br><span class="line">1 packets transmitted, 1 received, 0% packet loss, time 0ms</span><br><span class="line">rtt min/avg/max/mdev = 4.616/4.616/4.616/0.000 ms</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ping -c 1 -M <span class="keyword">do</span> -s 1500 216.58.204.110</span><br><span class="line"><span class="comment"># or ping -c 1 -M do -s 1473 216.58.204.110</span></span><br><span class="line"><span class="comment"># error output</span></span><br><span class="line">PING 216.58.204.110 (216.58.204.110) 1500(1528) bytes of data.</span><br><span class="line">ping: <span class="built_in">local</span> error: Message too long, mtu=1500</span><br><span class="line"></span><br><span class="line">--- 216.58.204.110 ping statistics ---</span><br><span class="line">1 packets transmitted, 0 received, +1 errors, 100% packet loss, time 0ms</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Cause&quot;&gt;&lt;a href=&quot;#Cause&quot; class=&quot;headerlink&quot; title=&quot;Cause&quot;&gt;&lt;/a&gt;Cause&lt;/h3&gt;&lt;hr&gt;
&lt;h3 id=&quot;Practice&quot;&gt;&lt;a href=&quot;#Practice&quot; class=&quot;headerlink&quot;
      
    
    </summary>
    
      <category term="Network" scheme="https://sulangsss.github.io/categories/Network/"/>
    
      <category term="UDP" scheme="https://sulangsss.github.io/categories/Network/UDP/"/>
    
    
      <category term="Network" scheme="https://sulangsss.github.io/tags/Network/"/>
    
      <category term="UDP" scheme="https://sulangsss.github.io/tags/UDP/"/>
    
  </entry>
  
  <entry>
    <title>ELK Filebeats Configuration</title>
    <link href="https://sulangsss.github.io/2019/08/29/ELK/Filebeats/Filebeats-Prospectors/"/>
    <id>https://sulangsss.github.io/2019/08/29/ELK/Filebeats/Filebeats-Prospectors/</id>
    <published>2019-08-29T10:13:06.000Z</published>
    <updated>2019-08-29T10:03:47.956Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li>[Configure inputs]<a href="https://www.elastic.co/guide/en/beats/filebeat/6.4/configuration-filebeat-options.html" target="_blank" rel="noopener">https://www.elastic.co/guide/en/beats/filebeat/6.4/configuration-filebeat-options.html</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Reference&quot;&gt;&lt;a href=&quot;#Reference&quot; class=&quot;headerlink&quot; title=&quot;Reference&quot;&gt;&lt;/a&gt;Reference&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;[Configure inputs]&lt;a href=&quot;https://w
      
    
    </summary>
    
      <category term="ELK" scheme="https://sulangsss.github.io/categories/ELK/"/>
    
      <category term="Filebeats" scheme="https://sulangsss.github.io/categories/ELK/Filebeats/"/>
    
    
      <category term="Configuration" scheme="https://sulangsss.github.io/tags/Configuration/"/>
    
      <category term="ELK" scheme="https://sulangsss.github.io/tags/ELK/"/>
    
      <category term="Filebeats" scheme="https://sulangsss.github.io/tags/Filebeats/"/>
    
  </entry>
  
  <entry>
    <title>ES Configurations</title>
    <link href="https://sulangsss.github.io/2019/08/29/ELK/ES/ES-Configuration/"/>
    <id>https://sulangsss.github.io/2019/08/29/ELK/ES/ES-Configuration/</id>
    <published>2019-08-29T10:13:06.000Z</published>
    <updated>2019-09-10T09:21:27.928Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Shards"><a href="#Shards" class="headerlink" title="Shards"></a>Shards</h3><h4 id="Modify-the-default-number-of-shards"><a href="#Modify-the-default-number-of-shards" class="headerlink" title="Modify the default number of shards"></a>Modify the default number of shards</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">PUT http://localhost:9200/_template/index_defaults </span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"template"</span>: <span class="string">"*"</span>, </span><br><span class="line">  <span class="string">"settings"</span>: &#123;</span><br><span class="line">    <span class="string">"number_of_shards"</span>: 1</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># curl -XPOST  -H "Content-Type:application/json" -d '&#123;"template":"*","settings":&#123;"number_of_shards":1&#125;&#125;' http://elasticsearch-client-service:9200/_template/default</span></span><br><span class="line"><span class="comment"># https://www.jianshu.com/p/f0e9ab2a47fe</span></span><br><span class="line"><span class="comment"># https://www.objectrocket.com/blog/elasticsearch/clustered-elasticsearch-best-practices/</span></span><br><span class="line"><span class="comment"># https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-templates.html</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Shards&quot;&gt;&lt;a href=&quot;#Shards&quot; class=&quot;headerlink&quot; title=&quot;Shards&quot;&gt;&lt;/a&gt;Shards&lt;/h3&gt;&lt;h4 id=&quot;Modify-the-default-number-of-shards&quot;&gt;&lt;a href=&quot;#Mo
      
    
    </summary>
    
      <category term="ELK" scheme="https://sulangsss.github.io/categories/ELK/"/>
    
      <category term="ES" scheme="https://sulangsss.github.io/categories/ELK/ES/"/>
    
    
      <category term="Configuration" scheme="https://sulangsss.github.io/tags/Configuration/"/>
    
      <category term="ELK" scheme="https://sulangsss.github.io/tags/ELK/"/>
    
      <category term="ES" scheme="https://sulangsss.github.io/tags/ES/"/>
    
  </entry>
  
  <entry>
    <title>ELK Logstash Configuration</title>
    <link href="https://sulangsss.github.io/2019/08/29/ELK/Logstash/Logstash-Configuration/"/>
    <id>https://sulangsss.github.io/2019/08/29/ELK/Logstash/Logstash-Configuration/</id>
    <published>2019-08-29T10:13:06.000Z</published>
    <updated>2019-08-29T10:03:06.762Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Plugins"><a href="#Plugins" class="headerlink" title="Plugins"></a>Plugins</h3><h4 id="Codec"><a href="#Codec" class="headerlink" title="Codec"></a>Codec</h4><p>Codec 是 logstash 从 1.3.0 版开始新引入的概念(Codec 来自 Coder/decoder 两个单词的首字母缩写)。</p><p>在此之前，logstash 只支持纯文本形式输入，然后以过滤器处理它。但现在，我们可以在输入 期处理不同类型的数据，这全是因为有了 codec 设置。</p><p>Logstash 不只是一个input | filter | output 的数据流，而是一个 input | decode | filter | encode | output 的数据流！codec 就是用来 decode、encode 事件的。</p><p>codec 的引入，使得 logstash 可以更好更方便的与其他有自定义数据格式的运维产品共存，比如 graphite、fluent、netflow、collectd，以及使用 msgpack、json、edn 等通用数据格式的其他产品等。</p><blockquote><p><a href="http://www.21yunwei.com/archives/5296" target="_blank" rel="noopener">http://www.21yunwei.com/archives/5296</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Plugins&quot;&gt;&lt;a href=&quot;#Plugins&quot; class=&quot;headerlink&quot; title=&quot;Plugins&quot;&gt;&lt;/a&gt;Plugins&lt;/h3&gt;&lt;h4 id=&quot;Codec&quot;&gt;&lt;a href=&quot;#Codec&quot; class=&quot;headerlink&quot; ti
      
    
    </summary>
    
      <category term="ELK" scheme="https://sulangsss.github.io/categories/ELK/"/>
    
      <category term="Logstash" scheme="https://sulangsss.github.io/categories/ELK/Logstash/"/>
    
    
      <category term="Configuration" scheme="https://sulangsss.github.io/tags/Configuration/"/>
    
      <category term="ELK" scheme="https://sulangsss.github.io/tags/ELK/"/>
    
      <category term="Logstash" scheme="https://sulangsss.github.io/tags/Logstash/"/>
    
  </entry>
  
  <entry>
    <title>MyBatis Usage</title>
    <link href="https://sulangsss.github.io/2019/08/27/Java/MyBatis/MyBatis-Usage/"/>
    <id>https://sulangsss.github.io/2019/08/27/Java/MyBatis/MyBatis-Usage/</id>
    <published>2019-08-27T10:32:13.000Z</published>
    <updated>2019-08-27T10:47:33.534Z</updated>
    
    <content type="html"><![CDATA[<h3 id="符号使用"><a href="#符号使用" class="headerlink" title="符号使用"></a>符号使用</h3><h4 id="和-的区别"><a href="#和-的区别" class="headerlink" title="# 和 $ 的区别"></a># 和 $ 的区别</h4><ul><li>使用 #{parameterName} 引用参数的时候，Mybatis 会把这个参数认为是一个字符串，例如 sql 传入参数 “Smith”，Select from emp where name = #{employeeName}；</li><li>使用 ${parameterName} 引用参数的时候，上述例子中的 sql 语句变为 Select from emp where name = Smith；</li></ul><p>简单来说，#{} 是经过预编译的是安全的，而 ${} 是未经过预编译的，仅仅是取变量的值是非安全的，存在 sql 注入的危险。# 将传入的数据都当成一个字符串，会对自动传入的数据加一个双引号。</p><hr><h3 id="ResultMap"><a href="#ResultMap" class="headerlink" title="ResultMap"></a>ResultMap</h3><hr><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li>[这也许是你不曾留意过的 Mybatis 细节]<a href="https://juejin.im/post/5bce743ee51d457a4b4f956f" target="_blank" rel="noopener">https://juejin.im/post/5bce743ee51d457a4b4f956f</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;符号使用&quot;&gt;&lt;a href=&quot;#符号使用&quot; class=&quot;headerlink&quot; title=&quot;符号使用&quot;&gt;&lt;/a&gt;符号使用&lt;/h3&gt;&lt;h4 id=&quot;和-的区别&quot;&gt;&lt;a href=&quot;#和-的区别&quot; class=&quot;headerlink&quot; title=&quot;# 和 $ 的
      
    
    </summary>
    
      <category term="Java" scheme="https://sulangsss.github.io/categories/Java/"/>
    
      <category term="MyBatis" scheme="https://sulangsss.github.io/categories/Java/MyBatis/"/>
    
    
      <category term="Java" scheme="https://sulangsss.github.io/tags/Java/"/>
    
      <category term="MyBatis" scheme="https://sulangsss.github.io/tags/MyBatis/"/>
    
      <category term="Usage" scheme="https://sulangsss.github.io/tags/Usage/"/>
    
  </entry>
  
  <entry>
    <title>MyBatis Paging Query</title>
    <link href="https://sulangsss.github.io/2019/08/26/Java/MyBatis/MyBatis-Page/"/>
    <id>https://sulangsss.github.io/2019/08/26/Java/MyBatis/MyBatis-Page/</id>
    <published>2019-08-26T07:32:13.000Z</published>
    <updated>2019-08-27T08:28:39.543Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Paging-Query"><a href="#Paging-Query" class="headerlink" title="Paging Query"></a>Paging Query</h3><h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id="getUserArticles" parameterType="Your_params" resultMap="resultUserArticleList"&gt;</span><br><span class="line">    <span class="keyword">select</span> </span><br><span class="line">    user.id,</span><br><span class="line">    user.userName,</span><br><span class="line">    user.userAddress,</span><br><span class="line">    article.id </span><br><span class="line">    aid,</span><br><span class="line">    article.title,</span><br><span class="line">    article.content </span><br><span class="line">    <span class="keyword">from</span> <span class="keyword">user</span>,article </span><br><span class="line">    <span class="keyword">where</span> user.id=article.userid <span class="keyword">and</span> user.id=#&#123;<span class="keyword">id</span>&#125; <span class="keyword">limit</span> #&#123;<span class="keyword">offset</span>&#125;,#&#123;pagesize&#125;</span><br><span class="line">&lt;/<span class="keyword">select</span>&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Paging-Query&quot;&gt;&lt;a href=&quot;#Paging-Query&quot; class=&quot;headerlink&quot; title=&quot;Paging Query&quot;&gt;&lt;/a&gt;Paging Query&lt;/h3&gt;&lt;h4 id=&quot;Example&quot;&gt;&lt;a href=&quot;#Exampl
      
    
    </summary>
    
      <category term="Java" scheme="https://sulangsss.github.io/categories/Java/"/>
    
      <category term="MyBatis" scheme="https://sulangsss.github.io/categories/Java/MyBatis/"/>
    
    
      <category term="Java" scheme="https://sulangsss.github.io/tags/Java/"/>
    
      <category term="MyBatis" scheme="https://sulangsss.github.io/tags/MyBatis/"/>
    
      <category term="Paging Query" scheme="https://sulangsss.github.io/tags/Paging-Query/"/>
    
  </entry>
  
  <entry>
    <title>MyBatis Delete</title>
    <link href="https://sulangsss.github.io/2019/08/26/Java/MyBatis/MyBatis-Delete/"/>
    <id>https://sulangsss.github.io/2019/08/26/Java/MyBatis/MyBatis-Delete/</id>
    <published>2019-08-26T07:32:13.000Z</published>
    <updated>2019-08-27T07:35:14.691Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Delete"><a href="#Delete" class="headerlink" title="Delete"></a>Delete</h3>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Delete&quot;&gt;&lt;a href=&quot;#Delete&quot; class=&quot;headerlink&quot; title=&quot;Delete&quot;&gt;&lt;/a&gt;Delete&lt;/h3&gt;
      
    
    </summary>
    
      <category term="Java" scheme="https://sulangsss.github.io/categories/Java/"/>
    
      <category term="MyBatis" scheme="https://sulangsss.github.io/categories/Java/MyBatis/"/>
    
    
      <category term="Java" scheme="https://sulangsss.github.io/tags/Java/"/>
    
      <category term="MyBatis" scheme="https://sulangsss.github.io/tags/MyBatis/"/>
    
      <category term="Delete" scheme="https://sulangsss.github.io/tags/Delete/"/>
    
  </entry>
  
  <entry>
    <title>MySQL Status</title>
    <link href="https://sulangsss.github.io/2019/08/26/DB/MySQL/MySQL-Status/"/>
    <id>https://sulangsss.github.io/2019/08/26/DB/MySQL/MySQL-Status/</id>
    <published>2019-08-26T04:13:13.000Z</published>
    <updated>2019-08-26T04:13:35.792Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Connections"><a href="#Connections" class="headerlink" title="Connections"></a>Connections</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">status</span> <span class="keyword">where</span> <span class="string">`variable_name`</span> = <span class="string">'Threads_connected'</span>;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Connections&quot;&gt;&lt;a href=&quot;#Connections&quot; class=&quot;headerlink&quot; title=&quot;Connections&quot;&gt;&lt;/a&gt;Connections&lt;/h3&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;
      
    
    </summary>
    
      <category term="DB" scheme="https://sulangsss.github.io/categories/DB/"/>
    
      <category term="MySQL" scheme="https://sulangsss.github.io/categories/DB/MySQL/"/>
    
    
      <category term="DB" scheme="https://sulangsss.github.io/tags/DB/"/>
    
      <category term="MySQL" scheme="https://sulangsss.github.io/tags/MySQL/"/>
    
      <category term="Stauts" scheme="https://sulangsss.github.io/tags/Stauts/"/>
    
  </entry>
  
  <entry>
    <title>MyBatis Batch</title>
    <link href="https://sulangsss.github.io/2019/08/23/Java/MyBatis/MyBatis-Batch/"/>
    <id>https://sulangsss.github.io/2019/08/23/Java/MyBatis/MyBatis-Batch/</id>
    <published>2019-08-23T11:27:13.000Z</published>
    <updated>2019-08-27T07:32:37.723Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Batch-Update"><a href="#Batch-Update" class="headerlink" title="Batch Update"></a>Batch Update</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">PositionMapper</span> </span>&#123;</span><br><span class="line">    <span class="function">fun <span class="title">insert</span><span class="params">(position: Position)</span>: Int</span></span><br><span class="line"><span class="function">    fun <span class="title">insertList</span><span class="params">(list: List&lt;Position&gt;)</span>: Int</span></span><br><span class="line"><span class="function">    fun <span class="title">updateList</span><span class="params">(list: List&lt;Position&gt;)</span>: Int</span></span><br><span class="line"><span class="function">    fun <span class="title">update</span><span class="params">(bean: Position)</span>: Int</span></span><br><span class="line"><span class="function">    fun <span class="title">find</span><span class="params">(id: Long)</span>: Position?</span></span><br><span class="line"><span class="function">    @Flush</span></span><br><span class="line"><span class="function">    fun <span class="title">flush</span><span class="params">()</span>: List&lt;BatchResult&gt;</span></span><br><span class="line"><span class="function">    fun <span class="title">deleteAll</span><span class="params">()</span></span></span><br><span class="line"><span class="function">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateList"</span> <span class="attr">parameterType</span>=<span class="string">"it.unimi.dsi.fastutil.objects.ReferenceArrayList"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"list"</span> <span class="attr">item</span>=<span class="string">"item"</span> <span class="attr">index</span>=<span class="string">"index"</span> <span class="attr">open</span>=<span class="string">""</span> <span class="attr">close</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">        update tb_positions set</span><br><span class="line">        size=#&#123;item.size&#125;,</span><br><span class="line">        cost=#&#123;item.cost&#125;,</span><br><span class="line">        status=#&#123;item.status&#125;,</span><br><span class="line">        update_time=#&#123;item.updateTime&#125;</span><br><span class="line">        where position_id=#&#123;item.positionId&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Usage</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">fun <span class="title">getBatchCount</span><span class="params">(results: List&lt;BatchResult&gt;)</span>: Int </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (results.isEmpty()) <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    val batchResult = results[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> (batchResult.updateCounts.isEmpty()) <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> batchResult.updateCounts[<span class="number">0</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">fun <span class="title">batchUpdate</span><span class="params">(positions: List&lt;Position&gt;)</span>: Boolean </span>&#123;</span><br><span class="line">    val session = MyBatisFactory.getSqlSession(type = ExecutorType.BATCH)</span><br><span class="line">    val mapper = session.getMapper(PositionMapper::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>)</span></span><br><span class="line"><span class="class">    <span class="title">return</span> <span class="title">try</span> </span>&#123;</span><br><span class="line">        mapper.updateList(positions)</span><br><span class="line">        results = mapper.flush()</span><br><span class="line">        val updateRow = MyBatisUtil.getBatchCount(results)</span><br><span class="line">        <span class="keyword">if</span> (updateRow &gt; <span class="number">0</span>) updateRow = positions.size</span><br><span class="line">        session.commit()</span><br><span class="line">        updateRow == positions.size</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e: RuntimeException) &#123;</span><br><span class="line">        logger.error(<span class="string">"batchUpdate(): occur error, error is"</span>, e)</span><br><span class="line">        session.rollback()</span><br><span class="line">        <span class="keyword">false</span></span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        session.close()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="Batch-Insert"><a href="#Batch-Insert" class="headerlink" title="Batch Insert"></a>Batch Insert</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertList"</span> <span class="attr">parameterType</span>=<span class="string">"it.unimi.dsi.fastutil.objects.ReferenceArrayList"</span>&gt;</span></span><br><span class="line">    INSERT INTO tb_positions(</span><br><span class="line">    size,</span><br><span class="line">    cost,</span><br><span class="line">    status,</span><br><span class="line">    create_time,</span><br><span class="line">    update_time</span><br><span class="line">    )</span><br><span class="line">    VALUES</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"list"</span> <span class="attr">item</span>=<span class="string">"it"</span> <span class="attr">index</span>=<span class="string">"index"</span> <span class="attr">separator</span>=<span class="string">","</span>&gt;</span></span><br><span class="line">        (</span><br><span class="line">        #&#123;it.size&#125;,</span><br><span class="line">        #&#123;it.cost&#125;,</span><br><span class="line">        #&#123;it.status&#125;,</span><br><span class="line">        #&#123;it.createTime&#125;,</span><br><span class="line">        #&#123;it.updateTime&#125;</span><br><span class="line">        )</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">fun <span class="title">batchInsert</span><span class="params">(positions: List&lt;Position&gt;)</span>: Boolean </span>&#123;</span><br><span class="line">    val session = MyBatisFactory.getSqlSession(type = ExecutorType.BATCH)</span><br><span class="line">    val mapper = session.getMapper(PositionMapper::<span class="class"><span class="keyword">class</span>.<span class="title">java</span>)</span></span><br><span class="line"><span class="class">    <span class="title">return</span> <span class="title">try</span> </span>&#123;</span><br><span class="line">        mapper.insertList(positions)</span><br><span class="line">        results = mapper.flush()</span><br><span class="line">        val insertRow = MyBatisUtil.getBatchCount(results)</span><br><span class="line">        session.commit()</span><br><span class="line">        insertRow == positions.size</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e: RuntimeException) &#123;</span><br><span class="line">        logger.error(<span class="string">"batchInsert(): occur error, error is"</span>, e)</span><br><span class="line">        session.rollback()</span><br><span class="line">        <span class="keyword">false</span></span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        session.close()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li><a href="https://blog.csdn.net/q957967519/article/details/88669552" target="_blank" rel="noopener">https://blog.csdn.net/q957967519/article/details/88669552</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Batch-Update&quot;&gt;&lt;a href=&quot;#Batch-Update&quot; class=&quot;headerlink&quot; title=&quot;Batch Update&quot;&gt;&lt;/a&gt;Batch Update&lt;/h3&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;t
      
    
    </summary>
    
      <category term="Java" scheme="https://sulangsss.github.io/categories/Java/"/>
    
      <category term="MyBatis" scheme="https://sulangsss.github.io/categories/Java/MyBatis/"/>
    
    
      <category term="Java" scheme="https://sulangsss.github.io/tags/Java/"/>
    
      <category term="MyBatis" scheme="https://sulangsss.github.io/tags/MyBatis/"/>
    
      <category term="Batch" scheme="https://sulangsss.github.io/tags/Batch/"/>
    
  </entry>
  
  <entry>
    <title>MySQL Preparement SQL</title>
    <link href="https://sulangsss.github.io/2019/08/22/DB/MySQL/Optimize/Preparement-SQL/"/>
    <id>https://sulangsss.github.io/2019/08/22/DB/MySQL/Optimize/Preparement-SQL/</id>
    <published>2019-08-22T04:08:13.000Z</published>
    <updated>2019-08-27T07:35:31.642Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h3><p>对于频繁使用的语句，使用服务端预编译+缓存效率还是能够得到可观的提升的。但是对于不频繁使用的语句，服务端预编译本身会增加额外的round-trip，因此在实际开发中可以视情况定夺使用本地预编译还是服务端预编译以及哪些sql语句不需要开启预编译等。</p><hr><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li>[从源码角度聊一聊JDBC和Mysql的预编译特性]<a href="https://my.oschina.net/kailuncen/blog/905395" target="_blank" rel="noopener">https://my.oschina.net/kailuncen/blog/905395</a></li><li>[预编译语句(Prepared Statements)介绍，以MySQL为例]<a href="https://www.cnblogs.com/micrari/p/7112781.html" target="_blank" rel="noopener">https://www.cnblogs.com/micrari/p/7112781.html</a></li><li>[MyBatis 原理浅析——基本原理]<a href="https://zhuanlan.zhihu.com/p/27039371" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/27039371</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Conclusion&quot;&gt;&lt;a href=&quot;#Conclusion&quot; class=&quot;headerlink&quot; title=&quot;Conclusion&quot;&gt;&lt;/a&gt;Conclusion&lt;/h3&gt;&lt;p&gt;对于频繁使用的语句，使用服务端预编译+缓存效率还是能够得到可观的提升的。但是
      
    
    </summary>
    
      <category term="DB" scheme="https://sulangsss.github.io/categories/DB/"/>
    
      <category term="MySQL" scheme="https://sulangsss.github.io/categories/DB/MySQL/"/>
    
      <category term="Optimize" scheme="https://sulangsss.github.io/categories/DB/MySQL/Optimize/"/>
    
    
      <category term="DB" scheme="https://sulangsss.github.io/tags/DB/"/>
    
      <category term="MySQL" scheme="https://sulangsss.github.io/tags/MySQL/"/>
    
      <category term="Optimize" scheme="https://sulangsss.github.io/tags/Optimize/"/>
    
      <category term="Preparement SQL" scheme="https://sulangsss.github.io/tags/Preparement-SQL/"/>
    
  </entry>
  
  <entry>
    <title>Kubernetes CI/CD OVH CDS</title>
    <link href="https://sulangsss.github.io/2019/08/19/Kubenetes/CI-CD/OVH-CDS/"/>
    <id>https://sulangsss.github.io/2019/08/19/Kubenetes/CI-CD/OVH-CDS/</id>
    <published>2019-08-19T09:35:06.000Z</published>
    <updated>2019-08-19T15:23:05.923Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Worker-Model"><a href="#Worker-Model" class="headerlink" title="Worker Model"></a>Worker Model</h3><h4 id="Attentions"><a href="#Attentions" class="headerlink" title="Attentions"></a>Attentions</h4><ol><li>What’s a restricted worker model?</li></ol><p>A <strong>shared.infra</strong> hatchery can launch all worker models, except <strong>‘restricted’</strong> worker models.</p><p>Use case: users can launch their own hatchery. To use their worker models only with their hatchery, they have to set worker model as ‘restricted’.</p><p>为什么需要使用 restricted mode？因为 CDS build 是基于 docker in docker 方式，在 docker 里面执行 docker 命令，需要依赖 –privileged 权限(启动 docker deamon 需要)。</p><p>特别注意：–privileged is implemented on swarm hatchery only</p><blockquote><p><a href="https://ovh.github.io/cds/docs/concepts/worker-model/" target="_blank" rel="noopener">https://ovh.github.io/cds/docs/concepts/worker-model/</a><br><a href="https://ovh.github.io/cds/docs/tutorials/worker_model-docker/" target="_blank" rel="noopener">https://ovh.github.io/cds/docs/tutorials/worker_model-docker/</a><br><a href="https://ovh.github.io/cds/docs/components/hatchery/" target="_blank" rel="noopener">https://ovh.github.io/cds/docs/components/hatchery/</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Worker-Model&quot;&gt;&lt;a href=&quot;#Worker-Model&quot; class=&quot;headerlink&quot; title=&quot;Worker Model&quot;&gt;&lt;/a&gt;Worker Model&lt;/h3&gt;&lt;h4 id=&quot;Attentions&quot;&gt;&lt;a href=&quot;#Att
      
    
    </summary>
    
      <category term="Kubernetes" scheme="https://sulangsss.github.io/categories/Kubernetes/"/>
    
      <category term="CI/CD" scheme="https://sulangsss.github.io/categories/Kubernetes/CI-CD/"/>
    
    
      <category term="Kubernetes" scheme="https://sulangsss.github.io/tags/Kubernetes/"/>
    
      <category term="CI/CD" scheme="https://sulangsss.github.io/tags/CI-CD/"/>
    
      <category term="OVH" scheme="https://sulangsss.github.io/tags/OVH/"/>
    
      <category term="CDS" scheme="https://sulangsss.github.io/tags/CDS/"/>
    
  </entry>
  
  <entry>
    <title>URL Shorteners</title>
    <link href="https://sulangsss.github.io/2019/08/17/Network/URL-Shorteners/"/>
    <id>https://sulangsss.github.io/2019/08/17/Network/URL-Shorteners/</id>
    <published>2019-08-17T15:44:19.000Z</published>
    <updated>2019-08-18T09:17:40.801Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Theory"><a href="#Theory" class="headerlink" title="Theory"></a>Theory</h3><ol><li>当我们在浏览器里输入 <a href="http://abc.com/RlB2d2" target="_blank" rel="noopener">http://abc.com/RlB2d2</a> 时，DNS首先解析获得 <a href="http://abc.com" target="_blank" rel="noopener">http://abc.com</a> 的 IP 地址 111.125.123.72；</li><li>当 DNS 获得 IP 地址以后，会向这个地址发送 HTTP GET 请求，查询短码 RlB2d2 对应的长 URL；</li><li>请求通过 HTTP 301 转到对应的长 URL <a href="https://m.domain.com。" target="_blank" rel="noopener">https://m.domain.com。</a></li></ol><hr><h3 id="301-与-302-的区别"><a href="#301-与-302-的区别" class="headerlink" title="301 与 302 的区别"></a>301 与 302 的区别</h3><p>301 是永久重定向，302 是临时重定向。短地址一经生成就不会变化，所以用 301 是符合 http 语义的，同时对服务器压力也会有一定减少。但是如果使用了 301，我们就无法统计到短地址被点击的次数了。而这个点击次数是一个非常有意思的大数据分析数据源。能够分析出的东西非常非常多。所以选择302虽然会增加服务器压力，但是我想是一个更好的选择。</p><hr><h3 id="URL-Shortener"><a href="#URL-Shortener" class="headerlink" title="URL Shortener"></a>URL Shortener</h3><h4 id="YOURLS"><a href="#YOURLS" class="headerlink" title="YOURLS"></a>YOURLS</h4><ul><li>YOURLS: <a href="http://yourls.org/" target="_blank" rel="noopener">http://yourls.org/</a><blockquote><p><a href="http://yourls.org/" target="_blank" rel="noopener">http://yourls.org/</a><br><a href="http://einverne.github.io/post/2018/04/yourls.html" target="_blank" rel="noopener">http://einverne.github.io/post/2018/04/yourls.html</a></p></blockquote></li></ul><p><strong>How to add plugin?</strong></p><p>default plugin directory: /var/www/html/user/plugins</p><p>Example: <a href="https://github.com/YOURLS/random-keywords" target="_blank" rel="noopener">https://github.com/YOURLS/random-keywords</a></p><p><strong>短地址生成书序</strong></p><p>短地址默认是是按照顺序生成，从1开始，有可能我们想不按照这样顺序，可以推荐用时间戳来生成</p><p>只需要修改 includes/functions.php 272行附近</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">将 $id = yourls_get_next_decimal(); 改为 $id = time();</span><br></pre></td></tr></table></figure><hr><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li>[短网址(short URL)系统的原理及其实现]<a href="https://segmentfault.com/a/1190000012088345" target="_blank" rel="noopener">https://segmentfault.com/a/1190000012088345</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Theory&quot;&gt;&lt;a href=&quot;#Theory&quot; class=&quot;headerlink&quot; title=&quot;Theory&quot;&gt;&lt;/a&gt;Theory&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;当我们在浏览器里输入 &lt;a href=&quot;http://abc.com/RlB2d2&quot; targe
      
    
    </summary>
    
      <category term="Network" scheme="https://sulangsss.github.io/categories/Network/"/>
    
    
      <category term="Network" scheme="https://sulangsss.github.io/tags/Network/"/>
    
      <category term="URL" scheme="https://sulangsss.github.io/tags/URL/"/>
    
  </entry>
  
  <entry>
    <title>Kotlin infix</title>
    <link href="https://sulangsss.github.io/2019/08/16/Java/Kotlin/infix/"/>
    <id>https://sulangsss.github.io/2019/08/16/Java/Kotlin/infix/</id>
    <published>2019-08-16T07:13:12.000Z</published>
    <updated>2019-08-16T07:30:04.621Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><h4 id="Add-new-add-operation-keyword"><a href="#Add-new-add-operation-keyword" class="headerlink" title="Add new add operation keyword"></a>Add new add operation keyword</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">infix fun Int.add(x: Int): Int &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span> + x</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">fun <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    val result = <span class="number">100</span> add <span class="number">200</span></span><br><span class="line">    println(result)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Add-add-operation-to-Class"><a href="#Add-add-operation-to-Class" class="headerlink" title="Add add operation to Class"></a>Add add operation to Class</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Account</span>(</span></span><br><span class="line">        private var balance: Double = 0.0</span><br><span class="line">) &#123;</span><br><span class="line">    <span class="function">infix fun <span class="title">add</span><span class="params">(amount: Double)</span>: Double </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.balance.plus(amount)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">fun <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    val account = Account(<span class="number">10.0</span>)</span><br><span class="line">    </span><br><span class="line">    val result = account add <span class="number">1.0</span></span><br><span class="line">    println(result)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//  result is 11.0</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Example&quot;&gt;&lt;a href=&quot;#Example&quot; class=&quot;headerlink&quot; title=&quot;Example&quot;&gt;&lt;/a&gt;Example&lt;/h3&gt;&lt;h4 id=&quot;Add-new-add-operation-keyword&quot;&gt;&lt;a href=&quot;#Add-
      
    
    </summary>
    
      <category term="Java" scheme="https://sulangsss.github.io/categories/Java/"/>
    
      <category term="Kotlin" scheme="https://sulangsss.github.io/categories/Java/Kotlin/"/>
    
    
      <category term="Kotlin" scheme="https://sulangsss.github.io/tags/Kotlin/"/>
    
      <category term="infix" scheme="https://sulangsss.github.io/tags/infix/"/>
    
  </entry>
  
  <entry>
    <title>Kotlin Extensions And Pipe</title>
    <link href="https://sulangsss.github.io/2019/08/16/Java/Kotlin/Extensions-Pipe/"/>
    <id>https://sulangsss.github.io/2019/08/16/Java/Kotlin/Extensions-Pipe/</id>
    <published>2019-08-16T07:03:12.000Z</published>
    <updated>2019-08-16T07:44:29.621Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">fun MutableList&lt;Int&gt;.swap(index1: Int, index2: Int) &#123;</span><br><span class="line">    val tmp = <span class="keyword">this</span>[index1] <span class="comment">// 'this' corresponds to the list</span></span><br><span class="line">    <span class="keyword">this</span>[index1] = <span class="keyword">this</span>[index2]</span><br><span class="line">    <span class="keyword">this</span>[index2] = tmp</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">val list = mutableListOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">list.swap(<span class="number">0</span>, <span class="number">2</span>) <span class="comment">// 'this' inside 'swap()' will hold the value of 'list'</span></span><br></pre></td></tr></table></figure><blockquote><p><a href="https://kotlinlang.org/docs/reference/extensions.html" target="_blank" rel="noopener">Extensions</a></p></blockquote><h3 id="Example-Pipe"><a href="#Example-Pipe" class="headerlink" title="Example - Pipe"></a>Example - Pipe</h3><h4 id="Arithmetics-Version-1"><a href="#Arithmetics-Version-1" class="headerlink" title="Arithmetics Version 1"></a>Arithmetics Version 1</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">fun <span class="title">multiplyByTwo</span><span class="params">(x: Int)</span>: Int </span>= x * <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="function">fun <span class="title">addOne</span><span class="params">(x: Int)</span>: Int </span>= x + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="function">fun <span class="title">addTwo</span><span class="params">(x: Int)</span> : Int </span>= x + <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="function">fun <span class="title">performOperations</span><span class="params">(x : Int)</span> : Int </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> multiplyByTwo(addTwo(addOne(x)))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Arithmetics-Version-2"><a href="#Arithmetics-Version-2" class="headerlink" title="Arithmetics Version 2"></a>Arithmetics Version 2</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">fun Int.addOne(): Int = <span class="keyword">this</span> + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">x.addOne()</span><br><span class="line"> .addTwo()</span><br><span class="line"> .multiplyByTwo()</span><br><span class="line"><span class="comment">//  or</span></span><br><span class="line">x.let &#123; addOne(<span class="keyword">this</span>) &#125;</span><br><span class="line"> .let &#123; addTwo(<span class="keyword">this</span>) &#125;</span><br><span class="line"> .let &#123; multiplyByTwo(<span class="keyword">this</span>) &#125;</span><br></pre></td></tr></table></figure><h4 id="Arithmetics-Version-3"><a href="#Arithmetics-Version-3" class="headerlink" title="Arithmetics Version 3"></a>Arithmetics Version 3</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">infix fun &lt;T&gt; T.then(func: (T) -&gt; T): T = func(<span class="keyword">this</span>)</span><br><span class="line"></span><br><span class="line">x then &#123; it + <span class="number">1</span> &#125; then &#123; it + <span class="number">2</span> &#125;</span><br></pre></td></tr></table></figure><h4 id="Arithmetics-Version-4"><a href="#Arithmetics-Version-4" class="headerlink" title="Arithmetics Version 4"></a>Arithmetics Version 4</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">fun &lt;T&gt; T.pipe(vararg functions: (T) -&gt; T): T &#123;</span><br><span class="line">    <span class="keyword">return</span> functions.fold(<span class="keyword">this</span>) &#123; value, f -&gt;</span><br><span class="line">        f(value)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">fun <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    val result = <span class="number">100</span>.pipe(::addOne, ::addTwo, ::multiplyByTwo)</span><br><span class="line">    println(result)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//  result is 206</span></span><br></pre></td></tr></table></figure><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li>[Kotlin pipeline syntax]<a href="https://medium.com/@krpiotrek/kotlin-pipeline-syntax-191b59429c38" target="_blank" rel="noopener">https://medium.com/@krpiotrek/kotlin-pipeline-syntax-191b59429c38</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Introduction&quot;&gt;&lt;a href=&quot;#Introduction&quot; class=&quot;headerlink&quot; title=&quot;Introduction&quot;&gt;&lt;/a&gt;Introduction&lt;/h3&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;t
      
    
    </summary>
    
      <category term="Java" scheme="https://sulangsss.github.io/categories/Java/"/>
    
      <category term="Kotlin" scheme="https://sulangsss.github.io/categories/Java/Kotlin/"/>
    
    
      <category term="Kotlin" scheme="https://sulangsss.github.io/tags/Kotlin/"/>
    
      <category term="Extensions" scheme="https://sulangsss.github.io/tags/Extensions/"/>
    
  </entry>
  
  <entry>
    <title>Kubernetes Eureka Deployment</title>
    <link href="https://sulangsss.github.io/2019/08/12/Kubenetes/Deployment/eureka-deployment/"/>
    <id>https://sulangsss.github.io/2019/08/12/Kubenetes/Deployment/eureka-deployment/</id>
    <published>2019-08-12T10:15:27.000Z</published>
    <updated>2019-08-12T11:32:17.075Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">eureka-headless-service</span></span><br><span class="line"><span class="attr">  labels:</span></span><br><span class="line"><span class="attr">    app:</span> <span class="string">eureka</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  ports:</span></span><br><span class="line"><span class="attr">    - name:</span> <span class="string">"8080"</span></span><br><span class="line"><span class="attr">      port:</span> <span class="number">8080</span> <span class="comment"># Service 提供的服务端口</span></span><br><span class="line"><span class="attr">      targetPort:</span> <span class="number">8080</span> <span class="comment"># 容器对应端口</span></span><br><span class="line"><span class="attr">  clusterIP:</span> <span class="string">None</span></span><br><span class="line"><span class="attr">  selector:</span></span><br><span class="line"><span class="attr">    app:</span> <span class="string">eureka</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># pod fixed address is eureka-0.eureka-headless-service</span></span><br><span class="line"></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">eureka-service</span> <span class="comment"># Service全局唯一名称</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  ports:</span></span><br><span class="line"><span class="attr">    - name:</span> <span class="string">"8080"</span></span><br><span class="line"><span class="attr">      port:</span> <span class="number">8080</span> <span class="comment"># Service 提供的服务端口</span></span><br><span class="line"><span class="attr">      targetPort:</span> <span class="number">8080</span> <span class="comment"># 容器对应端口</span></span><br><span class="line"><span class="attr">  selector:</span></span><br><span class="line"><span class="attr">    app:</span> <span class="string">eureka</span></span><br></pre></td></tr></table></figure><h3 id="Deployment"><a href="#Deployment" class="headerlink" title="Deployment"></a>Deployment</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1beta1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StatefulSet</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">  name:</span> <span class="string">eureka</span> <span class="comment"># 全局唯一名称</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"><span class="attr">  updateStrategy:</span></span><br><span class="line"><span class="attr">    type:</span> <span class="string">RollingUpdate</span></span><br><span class="line"><span class="attr">  selector:</span></span><br><span class="line"><span class="attr">    matchLabels:</span></span><br><span class="line"><span class="attr">      app:</span> <span class="string">eureka</span></span><br><span class="line"><span class="attr">  replicas:</span> <span class="number">2</span></span><br><span class="line"><span class="attr">  serviceName:</span> <span class="string">eureka-headless-service</span></span><br><span class="line"><span class="attr">  template:</span></span><br><span class="line"><span class="attr">    metadata:</span></span><br><span class="line"><span class="attr">      labels:</span></span><br><span class="line"><span class="attr">        app:</span> <span class="string">eureka</span></span><br><span class="line"><span class="attr">    spec:</span></span><br><span class="line"><span class="attr">      containers:</span></span><br><span class="line"><span class="attr">      - name:</span> <span class="string">eureka</span></span><br><span class="line"><span class="attr">        image:</span> </span><br><span class="line"><span class="attr">        resources:</span></span><br><span class="line"><span class="attr">          requests:</span></span><br><span class="line"><span class="attr">            memory:</span> <span class="number">256</span><span class="string">Mi</span></span><br><span class="line"><span class="attr">            cpu:</span> <span class="number">400</span><span class="string">m</span></span><br><span class="line"><span class="attr">          limits:</span></span><br><span class="line"><span class="attr">            cpu:</span> <span class="number">2.0</span></span><br><span class="line"><span class="attr">            memory:</span> <span class="number">512</span><span class="string">Mi</span></span><br><span class="line"><span class="attr">        ports:</span></span><br><span class="line"><span class="attr">        - containerPort:</span> <span class="number">8080</span></span><br><span class="line"><span class="attr">        env:</span></span><br><span class="line"><span class="attr">        - name:</span> <span class="string">POD_IP</span></span><br><span class="line"><span class="attr">          valueFrom:</span></span><br><span class="line"><span class="attr">            fieldRef:</span></span><br><span class="line"><span class="attr">              fieldPath:</span> <span class="string">status.podIP</span></span><br><span class="line"><span class="attr">        - name:</span> <span class="string">EUREKA_CLUSTER_URL</span></span><br><span class="line"><span class="attr">          value:</span> <span class="attr">http://eureka-0.eureka-headless-service:8080/eureka/,http://eureka-1.eureka-headless-service:8080/eureka/</span></span><br></pre></td></tr></table></figure><h3 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h3><ol><li>EMERGENCY! EUREKA MAY BE INCORRECTLY CLAIMING INSTANCES ARE UP WHEN THEY’RE NOT. RENEWALS ARE LESSER THAN THRESHOLD AND HENCE THE INSTANCES ARE NOT BEING EXPIRED JUST TO BE SAFE.</li></ol><p>保护模式主要用于一组客户端和Eureka Server之间存在网络分区场景下的保护。一旦进入保护模式，Eureka Server将会尝试保护其服务注册表中的信息，不再删除服务注册表中的数据（也就是不会注销任何微服务）。</p><p>原因是 Eureka Server 和其他的 Eureka Server 不能进行同步数据。</p><blockquote><p><a href="http://www.itmuch.com/spring-cloud-sum-eureka/" target="_blank" rel="noopener">http://www.itmuch.com/spring-cloud-sum-eureka/</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Service&quot;&gt;&lt;a href=&quot;#Service&quot; class=&quot;headerlink&quot; title=&quot;Service&quot;&gt;&lt;/a&gt;Service&lt;/h3&gt;&lt;figure class=&quot;highlight yaml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;
      
    
    </summary>
    
      <category term="Kubernetes" scheme="https://sulangsss.github.io/categories/Kubernetes/"/>
    
      <category term="Deployment" scheme="https://sulangsss.github.io/categories/Kubernetes/Deployment/"/>
    
    
      <category term="Kubernetes" scheme="https://sulangsss.github.io/tags/Kubernetes/"/>
    
      <category term="Eureka" scheme="https://sulangsss.github.io/tags/Eureka/"/>
    
  </entry>
  
  <entry>
    <title>Helm Harbor Installation</title>
    <link href="https://sulangsss.github.io/2019/08/07/Kubenetes/Helm/Harbor/"/>
    <id>https://sulangsss.github.io/2019/08/07/Kubenetes/Helm/Harbor/</id>
    <published>2019-08-07T09:15:19.000Z</published>
    <updated>2019-08-08T10:17:39.134Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Official-Site"><a href="#Official-Site" class="headerlink" title="Official Site"></a>Official Site</h3><p><a href="https://github.com/goharbor/harbor-helm" target="_blank" rel="noopener">https://github.com/goharbor/harbor-helm</a></p><p>Advice: </p><ul><li>Use branch 1.1.0.</li><li>Must be access Portal UI from HTTPS, not allow HTTP.</li><li>Harbor only supports Registry V2 API. You need to use Docker client 1.6.0 or higher.</li></ul><blockquote><p>[User Guide]<a href="https://github.com/goharbor/harbor/blob/master/docs/user_guide.md#pulling-and-pushing-images-using-docker-client" target="_blank" rel="noopener">https://github.com/goharbor/harbor/blob/master/docs/user_guide.md#pulling-and-pushing-images-using-docker-client</a><br>[搭建Harbor实战]<a href="https://www.dgstack.cn/archives/2185.html" target="_blank" rel="noopener">https://www.dgstack.cn/archives/2185.html</a></p></blockquote><h3 id="Configration"><a href="#Configration" class="headerlink" title="Configration"></a>Configration</h3><p>Chart.yaml</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">harbor</span></span><br><span class="line"><span class="attr">version:</span> <span class="number">1.1</span><span class="number">.1</span></span><br><span class="line"><span class="attr">appVersion:</span> <span class="number">1.8</span><span class="number">.1</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">An</span> <span class="string">open</span> <span class="string">source</span> <span class="string">trusted</span> <span class="string">cloud</span> <span class="string">native</span> <span class="string">registry</span> <span class="string">that</span> <span class="string">stores,</span> <span class="string">signs,</span> <span class="string">and</span> <span class="string">scans</span> <span class="string">content</span></span><br><span class="line"><span class="attr">keywords:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">docker</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">registry</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">harbor</span></span><br><span class="line"><span class="attr">home:</span> <span class="attr">https://goharbor.io</span></span><br><span class="line"><span class="attr">icon:</span> <span class="attr">https://raw.githubusercontent.com/goharbor/harbor/master/docs/img/harbor_logo.png</span></span><br><span class="line"><span class="attr">sources:</span></span><br><span class="line"><span class="attr">  - https:</span><span class="string">//github.com/goharbor/harbor</span></span><br><span class="line"><span class="attr">  - https:</span><span class="string">//github.com/goharbor/harbor-helm</span></span><br><span class="line"><span class="attr">maintainers:</span></span><br><span class="line"><span class="attr">  - name:</span> <span class="string">Jesse</span> <span class="string">Hu</span></span><br><span class="line"><span class="attr">    email:</span> <span class="string">huh@vmware.com</span></span><br><span class="line"><span class="attr">  - name:</span> <span class="string">paulczar</span></span><br><span class="line"><span class="attr">    email:</span> <span class="string">username.taken@gmail.com</span></span><br><span class="line"><span class="attr">engine:</span> <span class="string">gotpl</span></span><br></pre></td></tr></table></figure><p>values.yaml</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">expose:</span></span><br><span class="line">  <span class="comment"># Set the way how to expose the service. Set the type as "ingress", </span></span><br><span class="line">  <span class="comment"># "clusterIP", "nodePort" or "loadBalancer" and fill the information </span></span><br><span class="line">  <span class="comment"># in the corresponding section</span></span><br><span class="line"><span class="attr">  type:</span> <span class="string">loadBalancer</span></span><br><span class="line"><span class="attr">  tls:</span></span><br><span class="line">    <span class="comment"># Enable the tls or not. Note: if the type is "ingress" and the tls </span></span><br><span class="line">    <span class="comment"># is disabled, the port must be included in the command when pull/push</span></span><br><span class="line">    <span class="comment"># images. Refer to https://github.com/goharbor/harbor/issues/5291 </span></span><br><span class="line">    <span class="comment"># for the detail.</span></span><br><span class="line"><span class="attr">    enabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># Fill the name of secret if you want to use your own TLS certificate. </span></span><br><span class="line">    <span class="comment"># The secret must contain keys named:</span></span><br><span class="line">    <span class="comment"># "tls.crt" - the certificate</span></span><br><span class="line">    <span class="comment"># "tls.key" - the private key</span></span><br><span class="line">    <span class="comment"># "ca.crt" - the certificate of CA</span></span><br><span class="line">    <span class="comment"># These files will be generated automatically if the "secretName" is not set</span></span><br><span class="line"><span class="attr">    secretName:</span> <span class="string">""</span></span><br><span class="line">    <span class="comment"># By default, the Notary service will use the same cert and key as</span></span><br><span class="line">    <span class="comment"># described above. Fill the name of secret if you want to use a </span></span><br><span class="line">    <span class="comment"># separated one. Only needed when the type is "ingress".</span></span><br><span class="line"><span class="attr">    notarySecretName:</span> <span class="string">""</span></span><br><span class="line">    <span class="comment"># The common name used to generate the certificate, it's necessary</span></span><br><span class="line">    <span class="comment"># when the type isn't "ingress" and "secretName" is null</span></span><br><span class="line">    <span class="comment"># example: google.com</span></span><br><span class="line"><span class="attr">    commonName:</span> <span class="string">"must be set a name"</span></span><br><span class="line"><span class="attr">  ingress:</span></span><br><span class="line"><span class="attr">    hosts:</span></span><br><span class="line"><span class="attr">      core:</span> <span class="string">core.harbor.domain</span></span><br><span class="line"><span class="attr">      notary:</span> <span class="string">notary.harbor.domain</span></span><br><span class="line">    <span class="comment"># set to the type of ingress controller if it has specific requirements.</span></span><br><span class="line">    <span class="comment"># leave as `default` for most ingress controllers.</span></span><br><span class="line">    <span class="comment"># set to `gce` if using the GCE ingress controller</span></span><br><span class="line">    <span class="comment"># set to `ncp` if using the NCP (NSX-T Container Plugin) ingress controller</span></span><br><span class="line"><span class="attr">    controller:</span> <span class="string">default</span></span><br><span class="line"><span class="attr">    annotations:</span></span><br><span class="line">      <span class="string">ingress.kubernetes.io/ssl-redirect:</span> <span class="string">"true"</span></span><br><span class="line">      <span class="string">ingress.kubernetes.io/proxy-body-size:</span> <span class="string">"0"</span></span><br><span class="line">      <span class="string">nginx.ingress.kubernetes.io/ssl-redirect:</span> <span class="string">"true"</span></span><br><span class="line">      <span class="string">nginx.ingress.kubernetes.io/proxy-body-size:</span> <span class="string">"0"</span></span><br><span class="line"><span class="attr">  clusterIP:</span></span><br><span class="line">    <span class="comment"># The name of ClusterIP service</span></span><br><span class="line"><span class="attr">    name:</span> <span class="string">harbor</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line">      <span class="comment"># The service port Harbor listens on when serving with HTTP</span></span><br><span class="line"><span class="attr">      httpPort:</span> <span class="number">80</span></span><br><span class="line">      <span class="comment"># The service port Harbor listens on when serving with HTTPS</span></span><br><span class="line"><span class="attr">      httpsPort:</span> <span class="number">443</span></span><br><span class="line">      <span class="comment"># The service port Notary listens on. Only needed when notary.enabled </span></span><br><span class="line">      <span class="comment"># is set to true</span></span><br><span class="line"><span class="attr">      notaryPort:</span> <span class="number">4443</span></span><br><span class="line"><span class="attr">  nodePort:</span></span><br><span class="line">    <span class="comment"># The name of NodePort service</span></span><br><span class="line"><span class="attr">    name:</span> <span class="string">harbor</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line"><span class="attr">      http:</span></span><br><span class="line">        <span class="comment"># The service port Harbor listens on when serving with HTTP</span></span><br><span class="line"><span class="attr">        port:</span> <span class="number">80</span></span><br><span class="line">        <span class="comment"># The node port Harbor listens on when serving with HTTP</span></span><br><span class="line"><span class="attr">        nodePort:</span> <span class="number">30002</span></span><br><span class="line"><span class="attr">      https:</span></span><br><span class="line">        <span class="comment"># The service port Harbor listens on when serving with HTTPS</span></span><br><span class="line"><span class="attr">        port:</span> <span class="number">443</span></span><br><span class="line">        <span class="comment"># The node port Harbor listens on when serving with HTTPS</span></span><br><span class="line"><span class="attr">        nodePort:</span> <span class="number">30003</span></span><br><span class="line">      <span class="comment"># Only needed when notary.enabled is set to true</span></span><br><span class="line"><span class="attr">      notary:</span></span><br><span class="line">        <span class="comment"># The service port Notary listens on</span></span><br><span class="line"><span class="attr">        port:</span> <span class="number">4443</span></span><br><span class="line">        <span class="comment"># The node port Notary listens on</span></span><br><span class="line"><span class="attr">        nodePort:</span> <span class="number">30004</span></span><br><span class="line"><span class="attr">  loadBalancer:</span></span><br><span class="line">    <span class="comment"># The name of LoadBalancer service</span></span><br><span class="line"><span class="attr">    name:</span> <span class="string">harbor</span></span><br><span class="line">    <span class="comment"># Set the IP if the LoadBalancer supports assigning IP</span></span><br><span class="line"><span class="attr">    IP:</span> <span class="string">""</span></span><br><span class="line"><span class="attr">    ports:</span></span><br><span class="line">      <span class="comment"># The service port Harbor listens on when serving with HTTP</span></span><br><span class="line"><span class="attr">      httpPort:</span> <span class="number">80</span></span><br><span class="line">      <span class="comment"># The service port Harbor listens on when serving with HTTPS</span></span><br><span class="line"><span class="attr">      httpsPort:</span> <span class="number">443</span></span><br><span class="line">      <span class="comment"># The service port Notary listens on. Only needed when notary.enabled </span></span><br><span class="line">      <span class="comment"># is set to true</span></span><br><span class="line"><span class="attr">      notaryPort:</span> <span class="number">4443</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The external URL for Harbor core service. It is used to</span></span><br><span class="line"><span class="comment"># 1) populate the docker/helm commands showed on portal</span></span><br><span class="line"><span class="comment"># 2) populate the token service URL returned to docker/notary client</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># Format: protocol://domain[:port]. Usually:</span></span><br><span class="line"><span class="comment"># 1) if "expose.type" is "ingress", the "domain" should be </span></span><br><span class="line"><span class="comment"># the value of "expose.ingress.hosts.core"</span></span><br><span class="line"><span class="comment"># 2) if "expose.type" is "clusterIP", the "domain" should be</span></span><br><span class="line"><span class="comment"># the value of "expose.clusterIP.name"</span></span><br><span class="line"><span class="comment"># 3) if "expose.type" is "nodePort", the "domain" should be</span></span><br><span class="line"><span class="comment"># the IP address of k8s node </span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># If Harbor is deployed behind the proxy, set it as the URL of proxy</span></span><br><span class="line"><span class="attr">externalURL:</span> <span class="attr">https://core.harbor.domain</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The persistence is enabled by default and a default StorageClass</span></span><br><span class="line"><span class="comment"># is needed in the k8s cluster to provision volumes dynamicly. </span></span><br><span class="line"><span class="comment"># Specify another StorageClass in the "storageClass" or set "existingClaim"</span></span><br><span class="line"><span class="comment"># if you have already existing persistent volumes to use</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># For storing images and charts, you can also use "azure", "gcs", "s3", </span></span><br><span class="line"><span class="comment"># "swift" or "oss". Set it in the "imageChartStorage" section</span></span><br><span class="line"><span class="attr">persistence:</span></span><br><span class="line"><span class="attr">  enabled:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Setting it to "keep" to avoid removing PVCs during a helm delete </span></span><br><span class="line">  <span class="comment"># operation. Leaving it empty will delete PVCs after the chart deleted</span></span><br><span class="line"><span class="attr">  resourcePolicy:</span> <span class="string">"keep"</span></span><br><span class="line"><span class="attr">  persistentVolumeClaim:</span></span><br><span class="line"><span class="attr">    registry:</span></span><br><span class="line">      <span class="comment"># Use the existing PVC which must be created manually before bound, </span></span><br><span class="line">      <span class="comment"># and specify the "subPath" if the PVC is shared with other components</span></span><br><span class="line"><span class="attr">      existingClaim:</span> <span class="string">""</span></span><br><span class="line">      <span class="comment"># Specify the "storageClass" used to provision the volume. Or the default</span></span><br><span class="line">      <span class="comment"># StorageClass will be used(the default).</span></span><br><span class="line">      <span class="comment"># Set it to "-" to disable dynamic provisioning</span></span><br><span class="line"><span class="attr">      storageClass:</span> <span class="string">""</span></span><br><span class="line"><span class="attr">      subPath:</span> <span class="string">""</span></span><br><span class="line"><span class="attr">      accessMode:</span> <span class="string">ReadWriteOnce</span></span><br><span class="line"><span class="attr">      size:</span> <span class="number">100</span><span class="string">Gi</span></span><br><span class="line"><span class="attr">    chartmuseum:</span></span><br><span class="line"><span class="attr">      existingClaim:</span> <span class="string">""</span></span><br><span class="line"><span class="attr">      storageClass:</span> <span class="string">""</span></span><br><span class="line"><span class="attr">      subPath:</span> <span class="string">""</span></span><br><span class="line"><span class="attr">      accessMode:</span> <span class="string">ReadWriteOnce</span></span><br><span class="line"><span class="attr">      size:</span> <span class="number">5</span><span class="string">Gi</span></span><br><span class="line"><span class="attr">    jobservice:</span></span><br><span class="line"><span class="attr">      existingClaim:</span> <span class="string">""</span></span><br><span class="line"><span class="attr">      storageClass:</span> <span class="string">""</span></span><br><span class="line"><span class="attr">      subPath:</span> <span class="string">""</span></span><br><span class="line"><span class="attr">      accessMode:</span> <span class="string">ReadWriteOnce</span></span><br><span class="line"><span class="attr">      size:</span> <span class="number">10</span><span class="string">Gi</span></span><br><span class="line">    <span class="comment"># If external database is used, the following settings for database will </span></span><br><span class="line">    <span class="comment"># be ignored</span></span><br><span class="line"><span class="attr">    database:</span></span><br><span class="line"><span class="attr">      existingClaim:</span> <span class="string">""</span></span><br><span class="line"><span class="attr">      storageClass:</span> <span class="string">""</span></span><br><span class="line"><span class="attr">      subPath:</span> <span class="string">""</span></span><br><span class="line"><span class="attr">      accessMode:</span> <span class="string">ReadWriteOnce</span></span><br><span class="line"><span class="attr">      size:</span> <span class="number">20</span><span class="string">Gi</span></span><br><span class="line">    <span class="comment"># If external Redis is used, the following settings for Redis will </span></span><br><span class="line">    <span class="comment"># be ignored</span></span><br><span class="line"><span class="attr">    redis:</span></span><br><span class="line"><span class="attr">      existingClaim:</span> <span class="string">""</span></span><br><span class="line"><span class="attr">      storageClass:</span> <span class="string">""</span></span><br><span class="line"><span class="attr">      subPath:</span> <span class="string">""</span></span><br><span class="line"><span class="attr">      accessMode:</span> <span class="string">ReadWriteOnce</span></span><br><span class="line"><span class="attr">      size:</span> <span class="number">5</span><span class="string">Gi</span></span><br><span class="line">  <span class="comment"># Define which storage backend is used for registry and chartmuseum to store</span></span><br><span class="line">  <span class="comment"># images and charts. Refer to </span></span><br><span class="line">  <span class="comment"># https://github.com/docker/distribution/blob/master/docs/configuration.md#storage </span></span><br><span class="line">  <span class="comment"># for the detail.</span></span><br><span class="line"><span class="attr">  imageChartStorage:</span></span><br><span class="line">    <span class="comment"># Specify whether to disable `redirect` for images and chart storage, for </span></span><br><span class="line">    <span class="comment"># backends which not supported it (such as using minio for `s3` storage type), please disable </span></span><br><span class="line">    <span class="comment"># it. To disable redirects, simply set `disableredirect` to `true` instead. </span></span><br><span class="line">    <span class="comment"># Refer to </span></span><br><span class="line">    <span class="comment"># https://github.com/docker/distribution/blob/master/docs/configuration.md#redirect  </span></span><br><span class="line">    <span class="comment"># for the detail.</span></span><br><span class="line"><span class="attr">    disableredirect:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># Specify the type of storage: "filesystem", "azure", "gcs", "s3", "swift", </span></span><br><span class="line">    <span class="comment"># "oss" and fill the information needed in the corresponding section. The type</span></span><br><span class="line">    <span class="comment"># must be "filesystem" if you want to use persistent volumes for registry</span></span><br><span class="line">    <span class="comment"># and chartmuseum</span></span><br><span class="line"><span class="attr">    type:</span> <span class="string">filesystem</span></span><br><span class="line"><span class="attr">    filesystem:</span></span><br><span class="line"><span class="attr">      rootdirectory:</span> <span class="string">/storage</span></span><br><span class="line">      <span class="comment">#maxthreads: 100</span></span><br><span class="line"><span class="attr">    azure:</span></span><br><span class="line"><span class="attr">      accountname:</span> <span class="string">accountname</span></span><br><span class="line"><span class="attr">      accountkey:</span> <span class="string">base64encodedaccountkey</span></span><br><span class="line"><span class="attr">      container:</span> <span class="string">containername</span></span><br><span class="line">      <span class="comment">#realm: core.windows.net</span></span><br><span class="line"><span class="attr">    gcs:</span></span><br><span class="line"><span class="attr">      bucket:</span> <span class="string">bucketname</span></span><br><span class="line">      <span class="comment"># The base64 encoded json file which contains the key</span></span><br><span class="line"><span class="attr">      encodedkey:</span> <span class="string">base64-encoded-json-key-file</span></span><br><span class="line">      <span class="comment">#rootdirectory: /gcs/object/name/prefix</span></span><br><span class="line">      <span class="comment">#chunksize: "5242880"</span></span><br><span class="line"><span class="attr">    s3:</span></span><br><span class="line"><span class="attr">      region:</span> <span class="string">us-west-1</span></span><br><span class="line"><span class="attr">      bucket:</span> <span class="string">bucketname</span></span><br><span class="line">      <span class="comment">#accesskey: awsaccesskey</span></span><br><span class="line">      <span class="comment">#secretkey: awssecretkey</span></span><br><span class="line">      <span class="comment">#regionendpoint: http://myobjects.local</span></span><br><span class="line">      <span class="comment">#encrypt: false</span></span><br><span class="line">      <span class="comment">#keyid: mykeyid</span></span><br><span class="line">      <span class="comment">#secure: true</span></span><br><span class="line">      <span class="comment">#v4auth: true</span></span><br><span class="line">      <span class="comment">#chunksize: "5242880"</span></span><br><span class="line">      <span class="comment">#rootdirectory: /s3/object/name/prefix</span></span><br><span class="line">      <span class="comment">#storageclass: STANDARD</span></span><br><span class="line"><span class="attr">    swift:</span></span><br><span class="line"><span class="attr">      authurl:</span> <span class="attr">https://storage.myprovider.com/v3/auth</span></span><br><span class="line"><span class="attr">      username:</span> <span class="string">username</span></span><br><span class="line"><span class="attr">      password:</span> <span class="string">password</span></span><br><span class="line"><span class="attr">      container:</span> <span class="string">containername</span></span><br><span class="line">      <span class="comment">#region: fr</span></span><br><span class="line">      <span class="comment">#tenant: tenantname</span></span><br><span class="line">      <span class="comment">#tenantid: tenantid</span></span><br><span class="line">      <span class="comment">#domain: domainname</span></span><br><span class="line">      <span class="comment">#domainid: domainid</span></span><br><span class="line">      <span class="comment">#trustid: trustid</span></span><br><span class="line">      <span class="comment">#insecureskipverify: false</span></span><br><span class="line">      <span class="comment">#chunksize: 5M</span></span><br><span class="line">      <span class="comment">#prefix:</span></span><br><span class="line">      <span class="comment">#secretkey: secretkey</span></span><br><span class="line">      <span class="comment">#accesskey: accesskey</span></span><br><span class="line">      <span class="comment">#authversion: 3</span></span><br><span class="line">      <span class="comment">#endpointtype: public</span></span><br><span class="line">      <span class="comment">#tempurlcontainerkey: false</span></span><br><span class="line">      <span class="comment">#tempurlmethods:</span></span><br><span class="line"><span class="attr">    oss:</span></span><br><span class="line"><span class="attr">      accesskeyid:</span> <span class="string">accesskeyid</span></span><br><span class="line"><span class="attr">      accesskeysecret:</span> <span class="string">accesskeysecret</span></span><br><span class="line"><span class="attr">      region:</span> <span class="string">regionname</span></span><br><span class="line"><span class="attr">      bucket:</span> <span class="string">bucketname</span></span><br><span class="line">      <span class="comment">#endpoint: endpoint</span></span><br><span class="line">      <span class="comment">#internal: false</span></span><br><span class="line">      <span class="comment">#encrypt: false</span></span><br><span class="line">      <span class="comment">#secure: true</span></span><br><span class="line">      <span class="comment">#chunksize: 10M</span></span><br><span class="line">      <span class="comment">#rootdirectory: rootdirectory</span></span><br><span class="line"></span><br><span class="line"><span class="attr">imagePullPolicy:</span> <span class="string">IfNotPresent</span></span><br><span class="line"></span><br><span class="line"><span class="attr">logLevel:</span> <span class="string">debug</span></span><br><span class="line"><span class="comment"># The initial password of Harbor admin. Change it from portal after launching Harbor</span></span><br><span class="line"><span class="attr">harborAdminPassword:</span> <span class="string">"LeverUp"</span></span><br><span class="line"><span class="comment"># The secret key used for encryption. Must be a string of 16 chars.</span></span><br><span class="line"><span class="attr">secretKey:</span> <span class="string">"not-a-secure-key"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># If expose the service via "ingress", the Nginx will not be used</span></span><br><span class="line"><span class="attr">nginx:</span></span><br><span class="line"><span class="attr">  image:</span></span><br><span class="line"><span class="attr">    repository:</span> <span class="string">goharbor/nginx-photon</span></span><br><span class="line"><span class="attr">    tag:</span> <span class="string">v1.8.2-dev</span></span><br><span class="line"><span class="attr">  replicas:</span> <span class="number">1</span></span><br><span class="line">  <span class="comment"># resources:</span></span><br><span class="line">  <span class="comment">#  requests:</span></span><br><span class="line">  <span class="comment">#    memory: 256Mi</span></span><br><span class="line">  <span class="comment">#    cpu: 100m</span></span><br><span class="line"><span class="attr">  nodeSelector:</span></span><br><span class="line"><span class="attr">    node:</span> <span class="string">docker-repository</span></span><br><span class="line"><span class="attr">  tolerations:</span> <span class="string">[]</span></span><br><span class="line"><span class="attr">  affinity:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="comment">## Additional deployment annotations</span></span><br><span class="line"><span class="attr">  podAnnotations:</span> <span class="string">&#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">portal:</span></span><br><span class="line"><span class="attr">  image:</span></span><br><span class="line"><span class="attr">    repository:</span> <span class="string">goharbor/harbor-portal</span></span><br><span class="line"><span class="attr">    tag:</span> <span class="string">v1.8.2-dev</span></span><br><span class="line"><span class="attr">  replicas:</span> <span class="number">1</span></span><br><span class="line">  <span class="comment"># resources:</span></span><br><span class="line">  <span class="comment">#  requests:</span></span><br><span class="line">  <span class="comment">#    memory: 256Mi</span></span><br><span class="line">  <span class="comment">#    cpu: 100m</span></span><br><span class="line"><span class="attr">  nodeSelector:</span></span><br><span class="line"><span class="attr">    node:</span> <span class="string">docker-repository</span></span><br><span class="line"><span class="attr">  tolerations:</span> <span class="string">[]</span></span><br><span class="line"><span class="attr">  affinity:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="comment">## Additional deployment annotations</span></span><br><span class="line"><span class="attr">  podAnnotations:</span> <span class="string">&#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">core:</span></span><br><span class="line"><span class="attr">  image:</span></span><br><span class="line"><span class="attr">    repository:</span> <span class="string">goharbor/harbor-core</span></span><br><span class="line"><span class="attr">    tag:</span> <span class="string">v1.8.2-dev</span></span><br><span class="line"><span class="attr">  replicas:</span> <span class="number">1</span></span><br><span class="line">  <span class="comment"># resources:</span></span><br><span class="line">  <span class="comment">#  requests:</span></span><br><span class="line">  <span class="comment">#    memory: 256Mi</span></span><br><span class="line">  <span class="comment">#    cpu: 100m</span></span><br><span class="line"><span class="attr">  nodeSelector:</span></span><br><span class="line"><span class="attr">    node:</span> <span class="string">docker-repository</span></span><br><span class="line"><span class="attr">  tolerations:</span> <span class="string">[]</span></span><br><span class="line"><span class="attr">  affinity:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="comment">## Additional deployment annotations</span></span><br><span class="line"><span class="attr">  podAnnotations:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="comment"># Secret is used when core server communicates with other components.</span></span><br><span class="line">  <span class="comment"># If a secret key is not specified, Helm will generate one.</span></span><br><span class="line">  <span class="comment"># Must be a string of 16 chars.</span></span><br><span class="line"><span class="attr">  secret:</span> <span class="string">""</span></span><br><span class="line">  <span class="comment"># Fill the name of a kubernetes secret if you want to use your own</span></span><br><span class="line">  <span class="comment"># TLS certificate and private key for token encryption/decryption.</span></span><br><span class="line">  <span class="comment"># The secret must contain keys named:</span></span><br><span class="line">  <span class="comment"># "tls.crt" - the certificate</span></span><br><span class="line">  <span class="comment"># "tls.key" - the private key</span></span><br><span class="line">  <span class="comment"># The default key pair will be used if it isn't set</span></span><br><span class="line"><span class="attr">  secretName:</span> <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobservice:</span></span><br><span class="line"><span class="attr">  image:</span></span><br><span class="line"><span class="attr">    repository:</span> <span class="string">goharbor/harbor-jobservice</span></span><br><span class="line"><span class="attr">    tag:</span> <span class="string">v1.8.2-dev</span></span><br><span class="line"><span class="attr">  replicas:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  maxJobWorkers:</span> <span class="number">10</span></span><br><span class="line">  <span class="comment"># The logger for jobs: "file", "database" or "stdout"</span></span><br><span class="line"><span class="attr">  jobLogger:</span> <span class="string">file</span></span><br><span class="line">  <span class="comment"># resources:</span></span><br><span class="line">  <span class="comment">#   requests:</span></span><br><span class="line">  <span class="comment">#     memory: 256Mi</span></span><br><span class="line">  <span class="comment">#     cpu: 100m</span></span><br><span class="line"><span class="attr">  nodeSelector:</span></span><br><span class="line"><span class="attr">    node:</span> <span class="string">docker-repository</span></span><br><span class="line"><span class="attr">  tolerations:</span> <span class="string">[]</span></span><br><span class="line"><span class="attr">  affinity:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="comment">## Additional deployment annotations</span></span><br><span class="line"><span class="attr">  podAnnotations:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="comment"># Secret is used when job service communicates with other components.</span></span><br><span class="line">  <span class="comment"># If a secret key is not specified, Helm will generate one.</span></span><br><span class="line">  <span class="comment"># Must be a string of 16 chars.</span></span><br><span class="line"><span class="attr">  secret:</span> <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="attr">registry:</span></span><br><span class="line"><span class="attr">  registry:</span></span><br><span class="line"><span class="attr">    image:</span></span><br><span class="line"><span class="attr">      repository:</span> <span class="string">goharbor/registry-photon</span></span><br><span class="line"><span class="attr">      tag:</span> <span class="string">v1.8.2-dev</span></span><br><span class="line">    <span class="comment"># resources:</span></span><br><span class="line">    <span class="comment">#  requests:</span></span><br><span class="line">    <span class="comment">#    memory: 256Mi</span></span><br><span class="line">    <span class="comment">#    cpu: 100m</span></span><br><span class="line"><span class="attr">  controller:</span></span><br><span class="line"><span class="attr">    image:</span></span><br><span class="line"><span class="attr">      repository:</span> <span class="string">goharbor/harbor-registryctl</span></span><br><span class="line"><span class="attr">      tag:</span> <span class="string">v1.8.2-dev</span></span><br><span class="line">    <span class="comment"># resources:</span></span><br><span class="line">    <span class="comment">#  requests:</span></span><br><span class="line">    <span class="comment">#    memory: 256Mi</span></span><br><span class="line">    <span class="comment">#    cpu: 100m</span></span><br><span class="line"><span class="attr">  replicas:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">  nodeSelector:</span></span><br><span class="line"><span class="attr">    node:</span> <span class="string">docker-repository</span></span><br><span class="line"><span class="attr">  tolerations:</span> <span class="string">[]</span></span><br><span class="line"><span class="attr">  affinity:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="comment">## Additional deployment annotations</span></span><br><span class="line"><span class="attr">  podAnnotations:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="comment"># Secret is used to secure the upload state from client</span></span><br><span class="line">  <span class="comment"># and registry storage backend.</span></span><br><span class="line">  <span class="comment"># See: https://github.com/docker/distribution/blob/master/docs/configuration.md#http</span></span><br><span class="line">  <span class="comment"># If a secret key is not specified, Helm will generate one.</span></span><br><span class="line">  <span class="comment"># Must be a string of 16 chars.</span></span><br><span class="line"><span class="attr">  secret:</span> <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="attr">chartmuseum:</span></span><br><span class="line"><span class="attr">  enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  image:</span></span><br><span class="line"><span class="attr">    repository:</span> <span class="string">goharbor/chartmuseum-photon</span></span><br><span class="line"><span class="attr">    tag:</span> <span class="string">v1.8.2-dev</span></span><br><span class="line"><span class="attr">  replicas:</span> <span class="number">1</span></span><br><span class="line">  <span class="comment"># resources:</span></span><br><span class="line">  <span class="comment">#  requests:</span></span><br><span class="line">  <span class="comment">#    memory: 256Mi</span></span><br><span class="line">  <span class="comment">#    cpu: 100m</span></span><br><span class="line"><span class="attr">  nodeSelector:</span></span><br><span class="line"><span class="attr">    node:</span> <span class="string">docker-repository</span></span><br><span class="line"><span class="attr">  tolerations:</span> <span class="string">[]</span></span><br><span class="line"><span class="attr">  affinity:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="comment">## Additional deployment annotations</span></span><br><span class="line"><span class="attr">  podAnnotations:</span> <span class="string">&#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">clair:</span></span><br><span class="line"><span class="attr">  enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  image:</span></span><br><span class="line"><span class="attr">    repository:</span> <span class="string">goharbor/clair-photon</span></span><br><span class="line"><span class="attr">    tag:</span> <span class="string">v1.8.2-dev</span></span><br><span class="line"><span class="attr">  replicas:</span> <span class="number">1</span></span><br><span class="line">  <span class="comment"># The http(s) proxy used to update vulnerabilities database from internet</span></span><br><span class="line"><span class="attr">  httpProxy:</span></span><br><span class="line"><span class="attr">  httpsProxy:</span></span><br><span class="line">  <span class="comment"># The interval of clair updaters, the unit is hour, set to 0 to </span></span><br><span class="line">  <span class="comment"># disable the updaters</span></span><br><span class="line"><span class="attr">  updatersInterval:</span> <span class="number">12</span></span><br><span class="line">  <span class="comment"># resources:</span></span><br><span class="line">  <span class="comment">#  requests:</span></span><br><span class="line">  <span class="comment">#    memory: 256Mi</span></span><br><span class="line">  <span class="comment">#    cpu: 100m</span></span><br><span class="line"><span class="attr">  nodeSelector:</span></span><br><span class="line"><span class="attr">    node:</span> <span class="string">docker-repository</span></span><br><span class="line"><span class="attr">  tolerations:</span> <span class="string">[]</span></span><br><span class="line"><span class="attr">  affinity:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="comment">## Additional deployment annotations</span></span><br><span class="line"><span class="attr">  podAnnotations:</span> <span class="string">&#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">notary:</span></span><br><span class="line"><span class="attr">  enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">  server:</span></span><br><span class="line"><span class="attr">    image:</span></span><br><span class="line"><span class="attr">      repository:</span> <span class="string">goharbor/notary-server-photon</span></span><br><span class="line"><span class="attr">      tag:</span> <span class="string">v1.8.2-dev</span></span><br><span class="line"><span class="attr">    replicas:</span> <span class="number">1</span></span><br><span class="line">    <span class="comment"># resources:</span></span><br><span class="line">    <span class="comment">#  requests:</span></span><br><span class="line">    <span class="comment">#    memory: 256Mi</span></span><br><span class="line">    <span class="comment">#    cpu: 100m</span></span><br><span class="line"><span class="attr">  signer:</span></span><br><span class="line"><span class="attr">    image:</span></span><br><span class="line"><span class="attr">      repository:</span> <span class="string">goharbor/notary-signer-photon</span></span><br><span class="line"><span class="attr">      tag:</span> <span class="string">v1.8.2-dev</span></span><br><span class="line"><span class="attr">    replicas:</span> <span class="number">1</span></span><br><span class="line">    <span class="comment"># resources:</span></span><br><span class="line">    <span class="comment">#  requests:</span></span><br><span class="line">    <span class="comment">#    memory: 256Mi</span></span><br><span class="line">    <span class="comment">#    cpu: 100m</span></span><br><span class="line"><span class="attr">  nodeSelector:</span></span><br><span class="line"><span class="attr">    node:</span> <span class="string">docker-repository</span></span><br><span class="line"><span class="attr">  tolerations:</span> <span class="string">[]</span></span><br><span class="line"><span class="attr">  affinity:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="comment">## Additional deployment annotations</span></span><br><span class="line"><span class="attr">  podAnnotations:</span> <span class="string">&#123;&#125;</span></span><br><span class="line">  <span class="comment"># Fill the name of a kubernetes secret if you want to use your own</span></span><br><span class="line">  <span class="comment"># TLS certificate authority, certificate and private key for notary</span></span><br><span class="line">  <span class="comment"># communications.</span></span><br><span class="line">  <span class="comment"># The secret must contain keys named tls.ca, tls.crt and tls.key that</span></span><br><span class="line">  <span class="comment"># contain the CA, certificate and private key.</span></span><br><span class="line">  <span class="comment"># They will be generated if not set.</span></span><br><span class="line"><span class="attr">  secretName:</span> <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="attr">database:</span></span><br><span class="line">  <span class="comment"># if external database is used, set "type" to "external"</span></span><br><span class="line">  <span class="comment"># and fill the connection informations in "external" section</span></span><br><span class="line"><span class="attr">  type:</span> <span class="string">internal</span></span><br><span class="line"><span class="attr">  internal:</span></span><br><span class="line"><span class="attr">    image:</span></span><br><span class="line"><span class="attr">      repository:</span> <span class="string">goharbor/harbor-db</span></span><br><span class="line"><span class="attr">      tag:</span> <span class="string">v1.8.2-dev</span></span><br><span class="line">    <span class="comment"># The initial superuser password for internal database</span></span><br><span class="line"><span class="attr">    password:</span> <span class="string">"password"</span></span><br><span class="line">    <span class="comment"># resources:</span></span><br><span class="line">    <span class="comment">#  requests:</span></span><br><span class="line">    <span class="comment">#    memory: 256Mi</span></span><br><span class="line">    <span class="comment">#    cpu: 100m</span></span><br><span class="line"><span class="attr">    nodeSelector:</span></span><br><span class="line"><span class="attr">      node:</span> <span class="string">docker-repository</span></span><br><span class="line"><span class="attr">    tolerations:</span> <span class="string">[]</span></span><br><span class="line"><span class="attr">    affinity:</span> <span class="string">&#123;&#125;</span></span><br><span class="line"><span class="attr">  external:</span></span><br><span class="line"><span class="attr">    host:</span> <span class="string">"192.168.0.1"</span></span><br><span class="line"><span class="attr">    prort:</span> <span class="string">"5432"</span></span><br><span class="line"><span class="attr">    username:</span> <span class="string">"user"</span></span><br><span class="line"><span class="attr">    password:</span> <span class="string">"password"</span></span><br><span class="line"><span class="attr">    coreDatabase:</span> <span class="string">"registry"</span></span><br><span class="line"><span class="attr">    clairDatabase:</span> <span class="string">"clair"</span></span><br><span class="line"><span class="attr">    notaryServerDatabase:</span> <span class="string">"notary_server"</span></span><br><span class="line"><span class="attr">    notarySignerDatabase:</span> <span class="string">"notary_signer"</span></span><br><span class="line"><span class="attr">    sslmode:</span> <span class="string">"disable"</span></span><br><span class="line">  <span class="comment">## Additional deployment annotations</span></span><br><span class="line"><span class="attr">  podAnnotations:</span> <span class="string">&#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">redis:</span></span><br><span class="line">  <span class="comment"># if external Redis is used, set "type" to "external"</span></span><br><span class="line">  <span class="comment"># and fill the connection informations in "external" section</span></span><br><span class="line"><span class="attr">  type:</span> <span class="string">internal</span></span><br><span class="line"><span class="attr">  internal:</span></span><br><span class="line"><span class="attr">    image:</span></span><br><span class="line"><span class="attr">      repository:</span> <span class="string">goharbor/redis-photon</span></span><br><span class="line"><span class="attr">      tag:</span> <span class="string">v1.8.2-dev</span></span><br><span class="line">    <span class="comment"># resources:</span></span><br><span class="line">    <span class="comment">#  requests:</span></span><br><span class="line">    <span class="comment">#    memory: 256Mi</span></span><br><span class="line">    <span class="comment">#    cpu: 100m</span></span><br><span class="line"><span class="attr">    nodeSelector:</span></span><br><span class="line"><span class="attr">      node:</span> <span class="string">docker-repository</span></span><br><span class="line"><span class="attr">    tolerations:</span> <span class="string">[]</span></span><br><span class="line"><span class="attr">    affinity:</span> <span class="string">&#123;&#125;</span></span><br><span class="line"><span class="attr">  external:</span></span><br><span class="line"><span class="attr">    host:</span> <span class="string">"192.168.0.2"</span></span><br><span class="line"><span class="attr">    port:</span> <span class="string">"6379"</span></span><br><span class="line">    <span class="comment"># The "coreDatabaseIndex" must be "0" as the library Harbor</span></span><br><span class="line">    <span class="comment"># used doesn't support configuring it</span></span><br><span class="line"><span class="attr">    coreDatabaseIndex:</span> <span class="string">"0"</span></span><br><span class="line"><span class="attr">    jobserviceDatabaseIndex:</span> <span class="string">"1"</span></span><br><span class="line"><span class="attr">    registryDatabaseIndex:</span> <span class="string">"2"</span></span><br><span class="line"><span class="attr">    chartmuseumDatabaseIndex:</span> <span class="string">"3"</span></span><br><span class="line"><span class="attr">    password:</span> <span class="string">""</span></span><br><span class="line">  <span class="comment">## Additional deployment annotations</span></span><br><span class="line"><span class="attr">  podAnnotations:</span> <span class="string">&#123;&#125;</span></span><br></pre></td></tr></table></figure><hr><h3 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[security.go:280]: can not get user information from session</span><br><span class="line">[security.go:336]: user information is nil</span><br><span class="line">[security.go:350]: using <span class="built_in">local</span> database project manager</span><br><span class="line">[security.go:352]: creating <span class="built_in">local</span> database security context...</span><br></pre></td></tr></table></figure><p>Solution: switch branch 1.1.0, the branch had been solved it.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Official-Site&quot;&gt;&lt;a href=&quot;#Official-Site&quot; class=&quot;headerlink&quot; title=&quot;Official Site&quot;&gt;&lt;/a&gt;Official Site&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://github.co
      
    
    </summary>
    
      <category term="Kuberntes" scheme="https://sulangsss.github.io/categories/Kuberntes/"/>
    
      <category term="Helm" scheme="https://sulangsss.github.io/categories/Kuberntes/Helm/"/>
    
    
      <category term="Installation" scheme="https://sulangsss.github.io/tags/Installation/"/>
    
      <category term="Kuberntes" scheme="https://sulangsss.github.io/tags/Kuberntes/"/>
    
      <category term="Helm" scheme="https://sulangsss.github.io/tags/Helm/"/>
    
      <category term="Harbor" scheme="https://sulangsss.github.io/tags/Harbor/"/>
    
  </entry>
  
  <entry>
    <title>Kubernetes kubectl</title>
    <link href="https://sulangsss.github.io/2019/08/07/Kubenetes/Command/kubectl/"/>
    <id>https://sulangsss.github.io/2019/08/07/Kubenetes/Command/kubectl/</id>
    <published>2019-08-07T04:00:06.000Z</published>
    <updated>2019-08-07T08:42:58.835Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Inspect"><a href="#Inspect" class="headerlink" title="Inspect"></a>Inspect</h3><h4 id="Node"><a href="#Node" class="headerlink" title="Node"></a>Node</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl describe node [NODE_NAME]</span><br></pre></td></tr></table></figure><h3 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h3><h4 id="Proxy-Service"><a href="#Proxy-Service" class="headerlink" title="Proxy Service"></a>Proxy Service</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward $(kubectl get pod --selector=<span class="string">"label=value"</span> --output jsonpath=<span class="string">'&#123;.items[0].metadata.name&#125;'</span>) local_port:remote_port</span><br><span class="line"></span><br><span class="line"><span class="comment"># kubectl port-forward $(kubectl get pod --selector="component=portal" --output jsonpath='&#123;.items[0].metadata.name&#125;') 9000:80</span></span><br></pre></td></tr></table></figure><h3 id="Label"><a href="#Label" class="headerlink" title="Label"></a>Label</h3><h4 id="Add-label-to-Node"><a href="#Add-label-to-Node" class="headerlink" title="Add label to Node"></a>Add label to Node</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl label nodes &lt;node-name&gt; &lt;label-key&gt;=&lt;label-value&gt;</span><br></pre></td></tr></table></figure><p>example：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl label nodes gke-xxx-cc361276-cvfg node=elasticsearch</span><br></pre></td></tr></table></figure><h4 id="Remove-label-on-Node"><a href="#Remove-label-on-Node" class="headerlink" title="Remove label on Node"></a>Remove label on Node</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl label node node_name label_name-</span><br></pre></td></tr></table></figure><h3 id="Taint"><a href="#Taint" class="headerlink" title="Taint"></a>Taint</h3><h4 id="Add-taint-to-Node"><a href="#Add-taint-to-Node" class="headerlink" title="Add taint to Node"></a>Add taint to Node</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl taint nodes node1 key1=value1:NoSchedule</span><br><span class="line">kubectl taint nodes node1 key1=value1:NoExecute</span><br><span class="line">kubectl taint nodes node1 key2=value2:NoSchedule</span><br></pre></td></tr></table></figure><h4 id="Remove-taint-on-Node"><a href="#Remove-taint-on-Node" class="headerlink" title="Remove taint on Node"></a>Remove taint on Node</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl patch node node_name -p <span class="string">'&#123;"spec":&#123;"taints":[]&#125;&#125;'</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Inspect&quot;&gt;&lt;a href=&quot;#Inspect&quot; class=&quot;headerlink&quot; title=&quot;Inspect&quot;&gt;&lt;/a&gt;Inspect&lt;/h3&gt;&lt;h4 id=&quot;Node&quot;&gt;&lt;a href=&quot;#Node&quot; class=&quot;headerlink&quot; titl
      
    
    </summary>
    
      <category term="Kubernetes" scheme="https://sulangsss.github.io/categories/Kubernetes/"/>
    
      <category term="Command" scheme="https://sulangsss.github.io/categories/Kubernetes/Command/"/>
    
    
      <category term="Kubernetes" scheme="https://sulangsss.github.io/tags/Kubernetes/"/>
    
      <category term="kubectl" scheme="https://sulangsss.github.io/tags/kubectl/"/>
    
      <category term="Command" scheme="https://sulangsss.github.io/tags/Command/"/>
    
  </entry>
  
  <entry>
    <title>Kubernetes Dashboard</title>
    <link href="https://sulangsss.github.io/2019/08/07/Kubenetes/Dashboard/"/>
    <id>https://sulangsss.github.io/2019/08/07/Kubenetes/Dashboard/</id>
    <published>2019-08-07T03:43:06.000Z</published>
    <updated>2019-08-07T04:03:09.886Z</updated>
    
    <content type="html"><![CDATA[<h3 id="On-OVH"><a href="#On-OVH" class="headerlink" title="On OVH"></a>On OVH</h3><ol><li>kubectl apply -f <a href="https://raw.githubusercontent.com/kubernetes/dashboard/v1.10.1/src/deploy/recommended/kubernetes-dashboard.yaml" target="_blank" rel="noopener">https://raw.githubusercontent.com/kubernetes/dashboard/v1.10.1/src/deploy/recommended/kubernetes-dashboard.yaml</a></li><li>kubectl -n kube-system describe secret $(kubectl -n kube-system get secret | grep admin-user | awk ‘{print $1}’)</li><li>kubectl proxy / kubectl proxy –port=8001</li><li><a href="http://localhost:8001/api/v1/namespaces/kube-system/services/https:kubernetes-dashboard:/proxy/#!/workload?namespace=default" target="_blank" rel="noopener">http://localhost:8001/api/v1/namespaces/kube-system/services/https:kubernetes-dashboard:/proxy/#!/workload?namespace=default</a></li></ol><blockquote><p><a href="https://docs.ovh.com/gb/en/kubernetes/installing-kubernetes-dashboard/" target="_blank" rel="noopener">https://docs.ovh.com/gb/en/kubernetes/installing-kubernetes-dashboard/</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;On-OVH&quot;&gt;&lt;a href=&quot;#On-OVH&quot; class=&quot;headerlink&quot; title=&quot;On OVH&quot;&gt;&lt;/a&gt;On OVH&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;kubectl apply -f &lt;a href=&quot;https://raw.githubuser
      
    
    </summary>
    
      <category term="Kubernetes" scheme="https://sulangsss.github.io/categories/Kubernetes/"/>
    
    
      <category term="Kubernetes" scheme="https://sulangsss.github.io/tags/Kubernetes/"/>
    
      <category term="Dashboard" scheme="https://sulangsss.github.io/tags/Dashboard/"/>
    
  </entry>
  
  <entry>
    <title>Linux Kernel Network Settings</title>
    <link href="https://sulangsss.github.io/2019/08/06/Linux/Basic/Kernel-Network-Setting/"/>
    <id>https://sulangsss.github.io/2019/08/06/Linux/Basic/Kernel-Network-Setting/</id>
    <published>2019-08-06T04:35:06.000Z</published>
    <updated>2019-08-11T02:52:56.186Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Buffer"><a href="#Buffer" class="headerlink" title="Buffer"></a>Buffer</h3><h4 id="net-core"><a href="#net-core" class="headerlink" title="net.core.*"></a>net.core.*</h4><p>net.core.rmem_max: The net.core.rmem_max setting defines the maximum receive socket buffer size in bytes.<br>net.core.wmem_max: The net.core.wmem_max setting defines the maximum send socket buffer size in bytes.</p><blockquote><p>[A damp discussion of network queuing]<a href="https://lwn.net/Articles/616241/" target="_blank" rel="noopener">https://lwn.net/Articles/616241/</a></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sysctl -w net.core.rmem_max=8388608</span><br><span class="line">sysctl -w net.core.wmem_max=8388608</span><br><span class="line">sysctl -w net.core.rmem_default=65536</span><br><span class="line">sysctl -w net.core.wmem_default=65536</span><br><span class="line">sysctl -w net.ipv4.tcp_rmem=<span class="string">'4096 87380 8388608'</span></span><br><span class="line">sysctl -w net.ipv4.tcp_wmem=<span class="string">'4096 65536 8388608'</span></span><br><span class="line">sysctl -w net.ipv4.tcp_mem=<span class="string">'8388608 8388608 8388608'</span></span><br><span class="line">sysctl -w net.ipv4.route.flush=1</span><br></pre></td></tr></table></figure><h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><ul><li>[Linux-Sysctl-Performance-Tuning]<a href="https://judexzhu.github.io/Linux-Sysctl-Performance-Tuning/" target="_blank" rel="noopener">https://judexzhu.github.io/Linux-Sysctl-Performance-Tuning/</a></li><li>[How To: Network / TCP / UDP Tuning]<a href="https://wwwx.cs.unc.edu/~sparkst/howto/network_tuning.php" target="_blank" rel="noopener">https://wwwx.cs.unc.edu/~sparkst/howto/network_tuning.php</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;Buffer&quot;&gt;&lt;a href=&quot;#Buffer&quot; class=&quot;headerlink&quot; title=&quot;Buffer&quot;&gt;&lt;/a&gt;Buffer&lt;/h3&gt;&lt;h4 id=&quot;net-core&quot;&gt;&lt;a href=&quot;#net-core&quot; class=&quot;headerlink&quot; 
      
    
    </summary>
    
      <category term="Linux" scheme="https://sulangsss.github.io/categories/Linux/"/>
    
      <category term="Basic" scheme="https://sulangsss.github.io/categories/Linux/Basic/"/>
    
    
      <category term="Network" scheme="https://sulangsss.github.io/tags/Network/"/>
    
      <category term="Kernel" scheme="https://sulangsss.github.io/tags/Kernel/"/>
    
      <category term="Linux" scheme="https://sulangsss.github.io/tags/Linux/"/>
    
      <category term="Basic" scheme="https://sulangsss.github.io/tags/Basic/"/>
    
  </entry>
  
</feed>
