<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="google-site-verification" content="true">








  <meta name="baidu-site-verification" content="true">







  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/atom.xml" title="A Big Boy Blog -  Tech Articls & Notes" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2">






<meta property="og:type" content="website">
<meta property="og:title" content="A Big Boy Blog -  Tech Articls &amp; Notes">
<meta property="og:url" content="https://sulangsss.github.io/page/33/index.html">
<meta property="og:site_name" content="A Big Boy Blog -  Tech Articls &amp; Notes">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="A Big Boy Blog -  Tech Articls &amp; Notes">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.2',
    sidebar: {"position":"right","display":"always","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://sulangsss.github.io/page/33/">





<meta name="baidu-site-verification" content="xV2vphJ53Q">


  <title>A Big Boy Blog -  Tech Articls & Notes</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?344f3e8f33d176fceb44e65d30a341dc";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">A Big Boy Blog -  Tech Articls & Notes</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">Python Java Android Django Web -> sulang357159@gmail.com</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sulangsss.github.io/2018/02/26/Tools/GoogleCloud/gcloud-command/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason - sulang357159@163.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="A Big Boy Blog -  Tech Articls & Notes">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/26/Tools/GoogleCloud/gcloud-command/" itemprop="url">gcloud 常用命令</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-26T18:37:06+08:00">
                2018-02-26
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Tools/" itemprop="url" rel="index">
                    <span itemprop="name">Tools</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Tools/GCP/" itemprop="url" rel="index">
                    <span itemprop="name">GCP</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="gsutil"><a href="#gsutil" class="headerlink" title="gsutil"></a>gsutil</h3><h4 id="copy-bucket-to-another-bucket"><a href="#copy-bucket-to-another-bucket" class="headerlink" title="copy bucket to another bucket"></a>copy bucket to another bucket</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -L https://xx/xxx.rar | gsutil cp - gs://your/folder/xx.rar</span><br></pre></td></tr></table></figure>
<h3 id="update"><a href="#update" class="headerlink" title="update"></a>update</h3><h4 id="升级组件"><a href="#升级组件" class="headerlink" title="升级组件"></a>升级组件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcloud components update</span><br></pre></td></tr></table></figure>
<h3 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h3><h4 id="构建运行docker"><a href="#构建运行docker" class="headerlink" title="构建运行docker"></a>构建运行docker</h4><ul>
<li>Dockerfile</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FROM java:openjdk-8-jdk-alpine</span><br><span class="line">ADD ./root.war /root/root.war</span><br><span class="line">CMD ["java", "-jar", "/root/root.war"]</span><br><span class="line">EXPOSE 8080</span><br></pre></td></tr></table></figure>
<ul>
<li>Depoly</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认美国服务器</span></span><br><span class="line">gcloud container builds submit --tag gcr.io/[PROJECT_ID]/quickstart-image .</span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择亚洲服务器</span></span><br><span class="line">gcloud container builds submit --tag asia.gcr.io/[PROJECT_ID]/quickstart-image .</span><br></pre></td></tr></table></figure>
<p><strong>注意PROJECT_ID不是自定义的，而是自动生成的</strong></p>
<p>官方参考文档</p>
<ul>
<li><a href="https://cloud.google.com/container-builder/docs/quickstart-docker" target="_blank" rel="noopener">https://cloud.google.com/container-builder/docs/quickstart-docker</a></li>
</ul>
<h4 id="Push-Docker"><a href="#Push-Docker" class="headerlink" title="Push Docker"></a>Push Docker</h4><ol>
<li>命令格式：docker tag [IMAGE] [HOSTNAME]/[PROJECT-ID]/[IMAGE]</li>
</ol>
<p>例如，docker tag quickstart-image gcr.io/my-project/quickstart-image</p>
<ol start="2">
<li>命令格式：gcloud docker – push [HOSTNAME]/[PROJECT-ID]/[IMAGE]</li>
</ol>
<p>例如，gcloud docker – push gcr.io/my-project/quickstart-image</p>
<ol start="3">
<li>查看Image</li>
</ol>
<p><a href="https://console.cloud.google.com/gcr" target="_blank" rel="noopener">https://console.cloud.google.com/gcr</a></p>
<h4 id="Pull-Docker"><a href="#Pull-Docker" class="headerlink" title="Pull Docker"></a>Pull Docker</h4><ul>
<li>命令格式：gcloud docker – pull [HOSTNAME]/[PROJECT-ID]/[IMAGE]</li>
</ul>
<h4 id="View-Docker"><a href="#View-Docker" class="headerlink" title="View Docker"></a>View Docker</h4><ul>
<li>命令格式：gcloud container images list [HOSTNAME]/[PROJECT-ID]/[IMAGE]</li>
</ul>
<h4 id="Delete-Docker"><a href="#Delete-Docker" class="headerlink" title="Delete Docker"></a>Delete Docker</h4><ul>
<li>命令格式：gcloud container images delete [HOSTNAME]/[PROJECT-ID]/[IMAGE]</li>
</ul>
<h4 id="转换成Google构建脚本"><a href="#转换成Google构建脚本" class="headerlink" title="转换成Google构建脚本"></a>转换成Google构建脚本</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">steps:</span><br><span class="line">- name: 'gcr.io/cloud-builders/docker'</span><br><span class="line">    args: [ 'build', '-t', 'gcr.io/$PROJECT_ID/quickstart-image', '.' ]</span><br><span class="line">images:</span><br><span class="line">- 'gcr.io/$PROJECT_ID/quickstart-image'</span><br></pre></td></tr></table></figure>
<p>构建命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcloud container builds submit --config cloudbuild.yaml .</span><br></pre></td></tr></table></figure>
<p><strong>注意：在使用上述命令打包本地文件到GCP时候，会检查本地ignore配置文件，对于忽略的文件及文件夹不会被打包到GCP进行构建</strong></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sulangsss.github.io/2018/02/08/Server/SpringBoot/InterruptException/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason - sulang357159@163.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="A Big Boy Blog -  Tech Articls & Notes">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/08/Server/SpringBoot/InterruptException/" itemprop="url">Spring Boot 拦截异常</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-08T15:06:18+08:00">
                2018-02-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Server/" itemprop="url" rel="index">
                    <span itemprop="name">Server</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Server/Spring-Boot/" itemprop="url" rel="index">
                    <span itemprop="name">Spring Boot</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="拦截异常，统一处理"><a href="#拦截异常，统一处理" class="headerlink" title="拦截异常，统一处理"></a>拦截异常，统一处理</h3>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sulangsss.github.io/2018/02/08/Git/Command/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason - sulang357159@163.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="A Big Boy Blog -  Tech Articls & Notes">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/08/Git/Command/" itemprop="url">Git Command</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-08T11:55:12+08:00">
                2018-02-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/DevTools/" itemprop="url" rel="index">
                    <span itemprop="name">DevTools</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/DevTools/Git/" itemprop="url" rel="index">
                    <span itemprop="name">Git</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="checkout"><a href="#checkout" class="headerlink" title="checkout"></a>checkout</h2><h3 id="恢复删除文件"><a href="#恢复删除文件" class="headerlink" title="恢复删除文件"></a>恢复删除文件</h3><ul>
<li><p>方式一：命令格式：git checkout commit_id – file_name</p>
</li>
<li><p>方式二：命令格式：git ls-files</p>
</li>
</ul>
<h2 id="revert-和-reset"><a href="#revert-和-reset" class="headerlink" title="revert 和 reset"></a>revert 和 reset</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git reset --hard HEAD^        回退到上个版本</span><br><span class="line"></span><br><span class="line">git reset --hard commit_id    退到/进到 指定commit_id</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sulangsss.github.io/2018/02/08/读书笔记/记账方法/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason - sulang357159@163.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="A Big Boy Blog -  Tech Articls & Notes">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/08/读书笔记/记账方法/" itemprop="url">记账方法</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-08T09:10:07+08:00">
                2018-02-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Note/" itemprop="url" rel="index">
                    <span itemprop="name">Note</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="单式记账与复试记账的区别"><a href="#单式记账与复试记账的区别" class="headerlink" title="单式记账与复试记账的区别"></a>单式记账与复试记账的区别</h3><p>简单举例，50元购买豆子</p>
<ul>
<li><p>单式记账（single entry）</p>
</li>
<li><p>复试记账（double entry）</p>
</li>
</ul>
<p><strong><a href="https://zhuanlan.zhihu.com/p/21409873" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/21409873</a></strong></p>
<h3 id="收益性支出与资本性支出"><a href="#收益性支出与资本性支出" class="headerlink" title="收益性支出与资本性支出"></a>收益性支出与资本性支出</h3><ul>
<li><p>收益性支出不同于资本性支出，前者全部由当年的营业收入补偿，后者先记作资产，通过计提折旧或摊销分年摊入各年成本费用。</p>
</li>
<li><p>区分收益性支出和资本性支出，是为了正确计算各年损益和正确反映资产的价值。如把收益性支出作为资本性支出，结果是少计了当期费用，多计了资产价值，虚增利润；反之，则多计了当期费用，少计了资产价值，虚减利润。</p>
</li>
<li><p>资本性支出是指受益期超过一年或一个营业周期的支出，即发生该项支出不仅是为了取得本期收益，而且也是为了取得以后各期收益；收益性支出指受益期不超过一年或一个营业周期的支出，即发生该项支出是仅仅为了取得本期收益；收益性支出是该项支出是仅仅为了取得本期收益。</p>
</li>
</ul>
<p>简单举例，交纳照明电费2万元，这个电费是当期耗用读，要作为当期的费用，它影响当期的收益，所以是收益性支出。如果购买来一台价值2万元的设备，那么就不能作为费用一次性扣除。而是计入固定资产，在以后的受益期间采用合理的方法对该设备计提折旧，分期计入成本费用。这台设备的支出，就是资本性支出。</p>
<p>参考链接</p>
<ul>
<li><a href="http://wiki.mbalib.com/wiki/%E6%94%B6%E7%9B%8A%E6%80%A7%E6%94%AF%E5%87%BA" target="_blank" rel="noopener">http://wiki.mbalib.com/wiki/%E6%94%B6%E7%9B%8A%E6%80%A7%E6%94%AF%E5%87%BA</a></li>
</ul>
<h3 id="账户系统设计"><a href="#账户系统设计" class="headerlink" title="账户系统设计"></a>账户系统设计</h3><p><strong><a href="https://medium.com/@RobertKhou/double-entry-accounting-in-a-relational-database-2b7838a5d7f8" target="_blank" rel="noopener">https://medium.com/@RobertKhou/double-entry-accounting-in-a-relational-database-2b7838a5d7f8</a></strong></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sulangsss.github.io/2018/02/07/Linux/Command/firewall/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason - sulang357159@163.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="A Big Boy Blog -  Tech Articls & Notes">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/07/Linux/Command/firewall/" itemprop="url">UFW防火墙命令</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-07T10:15:57+08:00">
                2018-02-07
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/Command/" itemprop="url" rel="index">
                    <span itemprop="name">Command</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>UFW防火墙是一个主机端的iptables类防火墙配置工具。这个工具的目的是提供给用户一个可以轻松驾驭的界面，就像包集成和动态检测开放的端口一样。</p>
<h2 id="防火墙设置"><a href="#防火墙设置" class="headerlink" title="防火墙设置"></a>防火墙设置</h2><h3 id="禁用防火墙"><a href="#禁用防火墙" class="headerlink" title="禁用防火墙"></a>禁用防火墙</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">systemctl start iptables</span><br><span class="line">systemctl stop iptables</span><br><span class="line">systemctl <span class="built_in">disable</span> iptables</span><br><span class="line"></span><br><span class="line">ufw <span class="built_in">disable</span></span><br></pre></td></tr></table></figure>
<h3 id="查看防火墙状态-规则"><a href="#查看防火墙状态-规则" class="headerlink" title="查看防火墙状态/规则"></a>查看防火墙状态/规则</h3><p>ufw status</p>
<h3 id="关闭防火墙"><a href="#关闭防火墙" class="headerlink" title="关闭防火墙"></a>关闭防火墙</h3><p>ufw disable</p>
<h2 id="防火墙规则"><a href="#防火墙规则" class="headerlink" title="防火墙规则"></a>防火墙规则</h2><h3 id="默认规则"><a href="#默认规则" class="headerlink" title="默认规则"></a>默认规则</h3><p>ufw default deny</p>
<p>默认规则设置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ufw default allow outgoing</span><br><span class="line">ufw default deny incoming</span><br></pre></td></tr></table></figure>
<h3 id="开启端口-服务"><a href="#开启端口-服务" class="headerlink" title="开启端口/服务"></a>开启端口/服务</h3><p>允许22端口TCP和UDP</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ufw allow 22 等价 ufw allow ssh</span><br></pre></td></tr></table></figure>
<h3 id="关闭端口-服务"><a href="#关闭端口-服务" class="headerlink" title="关闭端口/服务"></a>关闭端口/服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ufw deny ssh</span><br></pre></td></tr></table></figure>
<h3 id="开启具体端口协议"><a href="#开启具体端口协议" class="headerlink" title="开启具体端口协议"></a>开启具体端口协议</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ufw allow 80/tcp</span><br><span class="line">ufw allow http/tcp</span><br></pre></td></tr></table></figure>
<h3 id="允许IP连接"><a href="#允许IP连接" class="headerlink" title="允许IP连接"></a>允许IP连接</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ufw allow from 123.45.67.89</span><br></pre></td></tr></table></figure>
<h3 id="允许特定子网"><a href="#允许特定子网" class="headerlink" title="允许特定子网"></a>允许特定子网</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ufw allow from 123.45.67.89/24</span><br></pre></td></tr></table></figure>
<p>参考链接</p>
<ul>
<li><a href="https://linux.cn/article-8087-1.html" target="_blank" rel="noopener">https://linux.cn/article-8087-1.html</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sulangsss.github.io/2018/02/06/Server/SpringBoot/validation/validator/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason - sulang357159@163.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="A Big Boy Blog -  Tech Articls & Notes">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/06/Server/SpringBoot/validation/validator/" itemprop="url">Spring Boot Validator API</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-06T14:48:18+08:00">
                2018-02-06
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Server/" itemprop="url" rel="index">
                    <span itemprop="name">Server</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Server/SpringBoot/" itemprop="url" rel="index">
                    <span itemprop="name">SpringBoot</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Server/SpringBoot/Validation/" itemprop="url" rel="index">
                    <span itemprop="name">Validation</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="注解类型"><a href="#注解类型" class="headerlink" title="注解类型"></a>注解类型</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Null</span>	只能是<span class="keyword">null</span></span><br><span class="line"><span class="meta">@NotNull</span> 不能为<span class="keyword">null</span> 注意用在基本类型上无效，基本类型有默认初始值</span><br><span class="line"><span class="meta">@AssertFalse</span> 必须为<span class="keyword">false</span></span><br><span class="line"><span class="meta">@AssertTrue</span>	必须是<span class="keyword">true</span></span><br><span class="line"></span><br><span class="line">字符串/数组/集合检查：(字符串本身就是个数组)</span><br><span class="line"><span class="meta">@Pattern</span>(regexp=<span class="string">"reg"</span>) 验证字符串满足正则</span><br><span class="line"><span class="meta">@Size</span>(max, min) 验证字符串、数组、集合长度范围</span><br><span class="line"><span class="meta">@NotEmpty</span> 验证字符串不为空或者<span class="keyword">null</span></span><br><span class="line"><span class="meta">@NotBlank</span> 验证字符串不为<span class="keyword">null</span>或者trim()后不为空</span><br><span class="line"></span><br><span class="line">数值检查：同时能验证一个字符串是否是满足限制的数字的字符串</span><br><span class="line"><span class="meta">@Max</span> 规定值得上限</span><br><span class="line"><span class="meta">@Min</span> 规定值得下限	</span><br><span class="line"><span class="meta">@DecimalMax</span>(<span class="string">"10.8"</span>)	以传入字符串构建一个BigDecimal，规定值要小于这个值 </span><br><span class="line"><span class="meta">@DecimalMin</span> 可以用来限制浮点数大小</span><br><span class="line"><span class="meta">@Digits</span>(int1, int2) 限制一个小数，整数精度小于int1；小数部分精度小于int2</span><br><span class="line"><span class="meta">@Digits</span> 无参数，验证字符串是否合法	</span><br><span class="line"><span class="meta">@Range</span>(min=long1,max=long2) 检查数字是否在范围之间</span><br><span class="line">这些都包括边界值</span><br><span class="line"></span><br><span class="line">日期检查：Date/Calendar</span><br><span class="line"><span class="meta">@Post</span> 限定一个日期，日期必须是过去的日期</span><br><span class="line"><span class="meta">@Future</span> 限定一个日期，日期必须是未来的日期</span><br><span class="line"></span><br><span class="line">其他验证：</span><br><span class="line"><span class="meta">@Vaild</span> 递归验证，用于对象、数组和集合，会对对象的元素、数组的元素进行一一校验</span><br><span class="line"><span class="meta">@Email</span> 用于验证一个字符串是否是一个合法的右键地址，空字符串或<span class="keyword">null</span>算验证通过</span><br><span class="line"><span class="meta">@URL</span>(protocol=,host=,port=,regexp=,flags=) 用于校验一个字符串是否是合法URL</span><br></pre></td></tr></table></figure>
<h3 id="validate-RequestParam"><a href="#validate-RequestParam" class="headerlink" title="validate RequestParam"></a>validate RequestParam</h3><ol>
<li>配置application</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ValidatorApplication</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function">fun <span class="title">methodValidationPostProcessor</span><span class="params">()</span>: MethodValidationPostProcessor </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> MethodValidationPostProcessor()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>增加异常处理</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GlobalExceptionHandler</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ExceptionHandler</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@ResponseStatus</span>(HttpStatus.BAD_REQUEST)</span><br><span class="line">    <span class="function">fun <span class="title">handle</span><span class="params">(exception: ValidationException)</span>: String </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"bad request, "</span> + exception.message)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"bad request, "</span> + exception.message</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>Controller使用</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Validated</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ValidatorController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function">fun <span class="title">hello</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            @Min(<span class="number">1</span>)</span></span></span><br><span class="line"><span class="function">            @<span class="title">Max</span><span class="params">(<span class="number">100</span>)</span></span></span><br><span class="line"><span class="function">            @<span class="title">RequestParam</span><span class="params">(<span class="string">"page"</span>, defaultValue = <span class="string">"1"</span>, required = <span class="keyword">false</span>)</span></span></span><br><span class="line"><span class="function">            page: Int,</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">            @<span class="title">Min</span><span class="params">(<span class="number">1</span>)</span></span></span><br><span class="line"><span class="function">            @<span class="title">Max</span><span class="params">(<span class="number">50</span>)</span></span></span><br><span class="line"><span class="function">            @<span class="title">RequestParam</span><span class="params">(<span class="string">"per_page"</span>, defaultValue = <span class="string">"15"</span>, required = <span class="keyword">false</span>)</span></span></span><br><span class="line"><span class="function">            per_page: Int</span></span><br><span class="line"><span class="function">    ): String </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"hello"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>Error</li>
</ol>
<ul>
<li>Request processing failed; nested exception is javax.validation.ConstraintViolationException</li>
</ul>
<p>单元测试page参数超过最大值时，抛出这个异常</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sulangsss.github.io/2018/02/05/Linux/Manjaro/Software/proxy/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason - sulang357159@163.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="A Big Boy Blog -  Tech Articls & Notes">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/05/Linux/Manjaro/Software/proxy/" itemprop="url">Manjaro Proxy</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-05T15:12:27+08:00">
                2018-02-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/Manjaro/" itemprop="url" rel="index">
                    <span itemprop="name">Manjaro</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/Manjaro/Software/" itemprop="url" rel="index">
                    <span itemprop="name">Software</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sulangsss.github.io/2018/02/05/Docker/docker-settings/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason - sulang357159@163.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="A Big Boy Blog -  Tech Articls & Notes">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/05/Docker/docker-settings/" itemprop="url">Docker 配置</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-05T13:45:19+08:00">
                2018-02-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Docker/" itemprop="url" rel="index">
                    <span itemprop="name">Docker</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h3><ul>
<li>创建代理配置文件<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /etc/systemd/system/docker.service.d</span><br><span class="line">vim /etc/systemd/system/docker.service.d/https-proxy.conf</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[Service]</span><br><span class="line">Environment="HTTP_PROXY=socks5://127.0.0.1:2010/" "HTTPS_PROXY=socks5://127.0.0.1:2010/" "NO_PROXY=localhost,127.0.0.1,docker.io,yanzhe919.mirror.aliyuncs.com,99nkhzdo.mirror.aliyuncs.com,*.aliyuncs.com,*.mirror.aliyuncs.com,registry.docker-cn.com,hub.c.163.com,hub-auth.c.163.com,"</span><br></pre></td></tr></table></figure>
<ul>
<li>重启docker服务</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure>
<h3 id="取消sudo权限"><a href="#取消sudo权限" class="headerlink" title="取消sudo权限"></a>取消sudo权限</h3><p>为什么需要创建docker用户组？<br>Docker守候进程绑定的是一个unix socket，而不是TCP端口。这个套接字默认的属主是root，其他是用户可以使用sudo命令来访问这个套接字文件。因为这个原因，docker服务进程都是以root帐号的身份运行的。</p>
<p>为了避免每次运行docker命令的时候都需要输入sudo，可以创建一个docker用户组，并把相应的用户添加到这个分组里面。当docker进程启动的时候，会设置该套接字可以被docker这个分组的用户读写。这样只要是在docker这个组里面的用户就可以直接执行docker命令了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo usermod -aG docker username</span><br></pre></td></tr></table></figure>
<p>执行测试命令<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker info</span><br></pre></td></tr></table></figure></p>
<p>如果报错：dial unix /var/run/docker.sock: connect: permission denied<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod a+rw /var/run/docker.sock</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sulangsss.github.io/2018/02/05/DB/MySQL/Conf/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason - sulang357159@163.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="A Big Boy Blog -  Tech Articls & Notes">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/05/DB/MySQL/Conf/" itemprop="url">MySQL 配置文件</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-05T11:43:19+08:00">
                2018-02-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/DB/" itemprop="url" rel="index">
                    <span itemprop="name">DB</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/DB/MySQL/" itemprop="url" rel="index">
                    <span itemprop="name">MySQL</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="参数解析"><a href="#参数解析" class="headerlink" title="参数解析"></a>参数解析</h3><h4 id="Innodb"><a href="#Innodb" class="headerlink" title="Innodb"></a>Innodb</h4><ul>
<li>innodb_buffer_pool_size</li>
</ul>
<p>缓冲池是数据和索引缓存的地方：这个值越大越好，这能保证你在大多数的读取操作时使用的是内存而不是硬盘。<br>典型的值是5-6GB(8GB内存)，20-25GB(32GB内存)，100-120GB(128GB内存)。</p>
<p>没有固定大小，50%测试值，看看情况再微调。但是尽量设置不要超过物理内存70%</p>
<p>这个参数主要作用是缓存innodb表的索引，数据，插入数据时的缓冲。专用mysql服务器设置的大小： 操作系统内存的70%-80%最佳。<br>此外，这个参数是非动态的，要修改这个值，需要重启mysqld服务。设置的过大，会导致system的swap空间被占用，导致操作系统变<br>慢，从而减低sql查询的效率。</p>
<ul>
<li>innodb_log_file_size</li>
</ul>
<p>redo日志被用于确保写操作快速而可靠并且在崩溃时恢复。从MySQL 5.5之后，崩溃恢复的性能的到了很大提升，<br>可以同时拥有较高的写入性能和崩溃恢复性能。在MySQL 5.6里可以被提高到4GB以上。如果应用程序需要频繁的<br>写入数据，可以一开始就把它这是成4G。</p>
<p>如果你有大量的大事务更改，那么，更改比默认innodb日志缓冲大小更大的值会对你的性能有一定的提高，但是你<br>使用的是autocommit，或者你的事务更改小于几k，那还是保持默认的值吧。</p>
<ul>
<li>innodb_file_per_table</li>
</ul>
<p>设置告知InnoDB是否需要将所有表的数据和索引存放在共享表空间里（innodb_file_per_table = OFF）或者为<br>每张表的数据单独放在一个.ibd文件（innodb_file_per_table = ON）。</p>
<p>每张表一个文件允许你在drop、truncate或者rebuild表时回收磁盘空间。这对于一些高级特性也是有必要的，比如<br>数据压缩。但是它不会带来任何性能收益。<strong>（MySQL5.6.6以后默认开启）</strong></p>
<ul>
<li>innodb_flush_log_at_trx_commit</li>
</ul>
<p>默认值为1，表示InnoDB完全支持ACID特性。当关注点是数据安全的时候这个值是最合适的，比如在一个主节点上。<br>但是对于磁盘（读写）速度较慢的系统，它会带来很巨大的开销，因为每次将改变flush到redo日志都需要额外的fsyncs。<br>如果值为0速度就更快了，但在系统崩溃时可能丢失一些数据, 所以一遍只适用于备份节点。</p>
<p>1是最安全的，0是性能最高，2折中</p>
<ul>
<li>innodb_flush_method</li>
</ul>
<p>这项配置决定了数据和日志写入硬盘的方式。一般来说，如果你有硬件RAID控制器，并且其独立缓存采用write-back机制，<br>并有着电池断电保护，那么应该设置配置为O_DIRECT；否则，大多数情况下应将其设为fdatasync（默认值）。sysbench<br>是一个可以帮助你决定这个选项的好工具。</p>
<ul>
<li>innodb_log_buffer_size</li>
</ul>
<p>innodb_log_buffer_size = 8M</p>
<p>这项配置决定了为尚未执行的事务分配的缓存。但是如果事务中包含有二进制大对象或者大文本字段的话，看Innodb_log_waits<br>状态变量，如果它不是0，增加innodb_log_buffer_size。</p>
<p>InnoDB的写操作，将数据写入到内存中的日志缓存中，由于InnoDB在事务提交前，并不将改变的日志写入到磁盘中，因此在大事务中，可以减轻磁盘I/O的压力。<br>通常情况下，如果不是写入大量的超大二进制数据（a lot of huge blobs），4MB-8MB已经足够了。此处我们设置为8M。</p>
<ul>
<li>innodb_additional_mem_pool_size</li>
</ul>
<p>innodb_additional_mem_pool_size = 16M</p>
<p>用来存放Innodb的内部目录，这个值不用分配太大，系统可以自动调。不用设置太高。通常比较大数据设置16Ｍ够用了，如果表比较多，<br>可以适当的增大。如果这个值自动增加，会在error log有中显示的。此处我们设置为16M。</p>
<h4 id="Table"><a href="#Table" class="headerlink" title="Table"></a>Table</h4><ul>
<li>table_open_cache</li>
</ul>
<p>MySQL每打开一个表，都会读入一些数据到table_open_cache缓存中，当MySQL在这个缓存中找不到相应信息时，才会去磁盘上读取。</p>
<h4 id="Connection"><a href="#Connection" class="headerlink" title="Connection"></a>Connection</h4><ul>
<li>max_allowed_packet</li>
</ul>
<p>接受的数据包大小；增加该变量的值十分安全，这是因为仅当需要时才会分配额外内存。例如，仅当你发出长查询或MySQLd必须返回大的结果行时<br>MySQLd才会分配更多内存。该变量之所以取较小默认值是一种预防措施，以捕获客户端和服务器之间的错误信息包，并确保不会因偶然使用大的信<br>息包而导致内存溢出</p>
<ul>
<li>max_connections</li>
</ul>
<p>max_connections = 800</p>
<p>最大连接数，根据同时在线人数设置一个比较综合的数字，最大不超过16384。此处我们根据系统使用量综合评估，设置为800。</p>
<ul>
<li>sort_buffer_size</li>
</ul>
<p>sort_buffer_size = 2M</p>
<p>一个connection级参数，在每个connection第一次需要使用这个buffer的时候，一次性分配设置的内存。并不是越大越好，由于是connection级的参数，<br>过大的设置+高并发可能会耗尽系统内存资源。官方文档推荐范围为256KB~2MB，这里我们设置为2M。</p>
<ul>
<li>read_buffer_size</li>
</ul>
<p>read_buffer_size = 2M</p>
<p>（数据文件存储顺序）是MySQL读入缓冲区的大小，将对表进行顺序扫描的请求将分配一个读入缓冲区，MySQL会为它分配一段内存缓冲区，read_buffer_size变量<br>控制这一缓冲区的大小，如果对表的顺序扫描非常频繁，并你认为频繁扫描进行的太慢，可以通过增加该变量值以及内存缓冲区大小提高其性能，read_buffer_size<br>变量控制这一提高表的顺序扫描的效率 数据文件顺序。此处我们设置得比默认值大一点，为2M。</p>
<ul>
<li>read_rnd_buffer_size</li>
</ul>
<p>read_rnd_buffer_size = 250K</p>
<p>MySQL的随机读缓冲区大小，当按任意顺序读取行时（列如按照排序顺序）将分配一个随机读取缓冲区，进行排序查询时，MySQL会首先扫描一遍该缓冲，以避免磁盘搜索，<br>提高查询速度，如果需要大量数据可适当的调整该值，但MySQL会为每个客户连接分配该缓冲区所以尽量适当设置该值，以免内存开销过大。表的随机的顺序缓冲 提高读取<br>的效率。此处设置为跟默认值相似，250KB。</p>
<ul>
<li>join_buffer_size</li>
</ul>
<p>join_buffer_size=250K</p>
<p>多表参与join操作时的分配缓存，适当分配，降低内存消耗，此处我们设置为250KB。</p>
<ul>
<li>thread_stack</li>
</ul>
<p>thread_stack=256K</p>
<p>每个连接线程被创建时，MySQL给它分配的内存大小。当MySQL创建一个新的连接线程时，需要给它分配一定大小的内存堆栈空间，以便存放客户端的请求的Query及自身的<br>各种状态和处理信息。Thread Cache 命中率：Thread_Cache_Hit = (Connections - Threads_created) / Connections * 100%;命中率处于90%才算正常<br>配置，当出现“mysql-debug: Thread stack overrun”的错误提示的时候需要增加该值。此处我们配置为256K。</p>
<ul>
<li>binlog_cache_size</li>
</ul>
<p>binlog_cache_size=250K</p>
<p>为每个session 分配的内存，在事务过程中用来存储二进制日志的缓存。作用是提高记录bin-log的效率。没有什么大事务，dml也不是很频繁的情况下可以设置小一点，<br>如果事务大而且多，dml操作也频繁，则可以适当的调大一点。前者建议是1048576  –1M；后者建议是： 2097152 – 4194304  即 2–4M。此处我们根据系统实<br>际，配置为250KB。</p>
<h4 id="Other"><a href="#Other" class="headerlink" title="Other"></a>Other</h4><ul>
<li>interactive_timeout</li>
</ul>
<p>服务器在关闭它前在一个交互连接上等待行动的秒数。一个交互的客户被定义为对 mysql_real_connect()使用client_interactive<br>选项的客户。 默认数值是28800，建议改为7200。</p>
<ul>
<li>key_buffer_size       </li>
</ul>
<p>key_buffer_size = 32M</p>
<p>指定索引缓冲区的大小，它决定索引处理的速度，尤其是索引读的速度。只对MyISAM表起作用。即使你不使用MyISAM表，<br>但是内部的临时磁盘表是MyISAM表，也要使用该值。由于我的数据库引擎为innodb，大部分表均为innodb，此处取默认值一半32M。</p>
<ul>
<li>query_cache_size</li>
</ul>
<p>query_cache_size = 64M</p>
<p>查询缓存大小，当打开时候，执行查询语句会进行缓存，读写都会带来额外的内存消耗，下次再次查询若命中该缓存会立刻返回结果。<br>默认改选项为关闭，打开则需要调整参数项query_cache_type=ON。此处采用默认值64M。</p>
<ul>
<li>mp_table_size</li>
</ul>
<p>mp_table_size = 64M</p>
<p>范围设置为64-256M最佳，当需要做类似group by操作生成的临时表大小，提高联接查询速度的效果，调整该值直到created_tmp_disk_tables / created_tmp_tables * 100% &lt;= 25%，<br>处于这样一个状态之下，效果较好，如果网站大部分为静态内容，可设置为64M，如果为动态页面，则设置为100M以上，不宜过大，导致内存不足I/O堵塞。此处我们设置为64M。</p>
<h3 id="environment"><a href="#environment" class="headerlink" title="environment"></a>environment</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MYSQL_ROOT_PASSWORD</span><br><span class="line"></span><br><span class="line">MYSQL_DATABASE</span><br><span class="line"></span><br><span class="line">MYSQL_USER, MYSQL_PASSWORD 配合MYSQL_DATABASE使用</span><br><span class="line"></span><br><span class="line">MYSQL_ALLOW_EMPTY_PASSWORD</span><br><span class="line"></span><br><span class="line">MYSQL_RANDOM_ROOT_PASSWORD</span><br><span class="line"></span><br><span class="line">MYSQL_ONETIME_PASSWORD</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://sulangsss.github.io/2018/02/05/Kubenetes/Command/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason - sulang357159@163.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="A Big Boy Blog -  Tech Articls & Notes">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/05/Kubenetes/Command/" itemprop="url">kubectl 命令</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-05T11:13:06+08:00">
                2018-02-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/Kubernetes/" itemprop="url" rel="index">
                    <span itemprop="name">Kubernetes</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Log"><a href="#Log" class="headerlink" title="Log"></a>Log</h2><h3 id="查看log"><a href="#查看log" class="headerlink" title="查看log"></a>查看log</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Display only the most recent 20 lines of output in pod nginx</span></span><br><span class="line">kubectl logs --tail=20 nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># Show all logs from pod nginx written in the last hour</span></span><br><span class="line">kubectl logs --since=1h nginx</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Pod"><a href="#Pod" class="headerlink" title="Pod"></a>Pod</h2><h3 id="exec"><a href="#exec" class="headerlink" title="exec"></a>exec</h3><h4 id="Multiple-Pods"><a href="#Multiple-Pods" class="headerlink" title="Multiple Pods"></a>Multiple Pods</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl describe pod/engine-0 -n default</span><br><span class="line"></span><br><span class="line">kubectl <span class="built_in">exec</span> -it engine-0 -c telegraf /bin/sh</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="cp"><a href="#cp" class="headerlink" title="cp"></a>cp</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Examples:</span><br><span class="line"><span class="comment"># !!!Important Note!!!</span></span><br><span class="line"><span class="comment"># Requires that the 'tar' binary is present in your container</span></span><br><span class="line"><span class="comment"># image.  If 'tar' is not present, 'kubectl cp' will fail.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Copy /tmp/foo_dir local directory to /tmp/bar_dir in a remote pod in the default namespace</span></span><br><span class="line">kubectl cp /tmp/foo_dir &lt;some-pod&gt;:/tmp/bar_dir</span><br><span class="line"></span><br><span class="line"><span class="comment"># Copy /tmp/foo local file to /tmp/bar in a remote pod in a specific container</span></span><br><span class="line">kubectl cp /tmp/foo &lt;some-pod&gt;:/tmp/bar -c &lt;specific-container&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Copy /tmp/foo local file to /tmp/bar in a remote pod in namespace &lt;some-namespace&gt;</span></span><br><span class="line">kubectl cp /tmp/foo &lt;some-namespace&gt;/&lt;some-pod&gt;:/tmp/bar</span><br><span class="line"></span><br><span class="line"><span class="comment"># Copy /tmp/foo from a remote pod to /tmp/bar locally</span></span><br><span class="line">kubectl cp &lt;some-namespace&gt;/&lt;some-pod&gt;:/tmp/foo /tmp/bar</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="delete"><a href="#delete" class="headerlink" title="delete"></a>delete</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl delete pods -l name=myLabel</span><br><span class="line"></span><br><span class="line">kubectl delete pods --all</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="查看Pod里面指定容器的log"><a href="#查看Pod里面指定容器的log" class="headerlink" title="查看Pod里面指定容器的log"></a>查看Pod里面指定容器的log</h3><p>对于有初始化init container的StatefulSet，可以查看里面不同的container的log</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl logs &lt;pod-name&gt; -c &lt;init-container&gt;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="create"><a href="#create" class="headerlink" title="create"></a>create</h3><p>功能：根据文件或输入创建集群resource</p>
<p>例如，kubectl create -f filename</p>
<hr>
<h3 id="apply"><a href="#apply" class="headerlink" title="apply"></a>apply</h3><p>apply命令提供了比patch，edit等更严格的更新resource的方式。通过apply，用户可以将resource的configuration使用source control的<br>方式维护在版本库中。</p>
<p>每次有更新时，将配置文件push到server，然后使用kubectl apply将更新应用到resource。kubernetes会在引用更新前将当前配置文件中的配置同<br>已经应用的配置做比较，并只更新更改的部分，而不会主动更改任何用户未指定的部分。 </p>
<p>apply命令的使用方式同replace相同，不同的是apply不会删除原有resource，然后创建新的。apply直接在原有resource的基础上进行更新。同时<br>kubectl apply还会resource中添加一条注释，标记当前的apply。类似于git操作。</p>
<hr>
<h3 id="replace"><a href="#replace" class="headerlink" title="replace"></a>replace</h3><p>功能：对已有资源进行更新、替换。</p>
<hr>
<h3 id="rolling-update"><a href="#rolling-update" class="headerlink" title="rolling-update"></a>rolling-update</h3><p>对于已经部署并且正在运行的业务，rolling-update提供了不中断业务的更新方式。rolling-update每次起一个新的pod，等新pod完全起来后删除一个旧的pod，<br>然后再起一个新的pod替换旧的pod，直到替换掉所有的pod。rolling-update需要确保新的版本有不同的name，Version和label，否则会报错 。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl <span class="built_in">set</span> image deployment/deployment-name container_name=image</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="scale"><a href="#scale" class="headerlink" title="scale"></a>scale</h3><h4 id="Deployment"><a href="#Deployment" class="headerlink" title="Deployment"></a>Deployment</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl scale --current-replicas=1 --replicas=3 deployment/mysql</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="attach"><a href="#attach" class="headerlink" title="attach"></a>attach</h3><p>命令类似于docker的attach命令，可以直接查看容器中以daemon形式运行的进程的输出，效果类似于logs -f，退出查看使用ctrl-c。</p>
<p>如果一个pod中有多个容器，要查看具体的某个容器的的输出，需要在pod名后使用-c containers name指定运行的容器。</p>
<p>如下示例的命令为查看kube-system namespace中的kube-dns-v9-rcfuk pod中的skydns容器的输出。</p>
<p>gcloud container clusters get-credentials fintend-cloud –zone asia-southeast1-a –project fintend-cloud &amp;&amp; kubectl exec -it kafka-deployment-6798bf4956-z2b25 -c kafka-deployment – /bin/sh</p>
<hr>
<h3 id="proxy"><a href="#proxy" class="headerlink" title="proxy"></a>proxy</h3><p>访问内部Pod服务</p>
<p>格式：kubectl port-forward pod-name local-port:remote-port</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl port-forward app-deployment-9969cc4c-hntw9 8086:8086</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="Builder"><a href="#Builder" class="headerlink" title="Builder"></a>Builder</h3><h4 id="local"><a href="#local" class="headerlink" title="local"></a>local</h4><p>container-builder-local</p>
<p>./container-builder-local_{linux,darwin}_{386,amd64}-v&lt;latest_tag&gt; –dryrun=false –config=path/to/cloudbuild.yaml path/to/code</p>
<h4 id="remote"><a href="#remote" class="headerlink" title="remote"></a>remote</h4><p>gcloud container builds submit –config cloudbuild.yaml .</p>
<p>gcloud builds submit –config cloudbuild.yaml .</p>
<h2 id="Cluster"><a href="#Cluster" class="headerlink" title="Cluster"></a>Cluster</h2><hr>
<h3 id="fetch-cluster-auth"><a href="#fetch-cluster-auth" class="headerlink" title="fetch cluster auth"></a>fetch cluster auth</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcloud container clusters get-credentials cluster_name --zone asia-southeast1<span class="_">-a</span> --project project_id</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="scale-1"><a href="#scale-1" class="headerlink" title="scale"></a>scale</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcloud container clusters resize cluster-name --node-pool default-pool --size 5 --zone asia-southeast1<span class="_">-a</span></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h2><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><h4 id="查看Service信息"><a href="#查看Service信息" class="headerlink" title="查看Service信息"></a>查看Service信息</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl describe service service_name</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="Service类型"><a href="#Service类型" class="headerlink" title="Service类型"></a>Service类型</h3><p>参考链接：<a href="https://segmentfault.com/a/1190000013840788" target="_blank" rel="noopener">https://segmentfault.com/a/1190000013840788</a></p>
<h4 id="headless-service"><a href="#headless-service" class="headerlink" title="headless service"></a>headless service</h4><p>当headless service有配置selector时，其对应的所有后端节点，会被记录到dns中，在访问service domain时kube-dns会将所有endpoints返回，选择哪个进行访问则是系统自己决定；</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Service</span><br><span class="line">metadata:</span><br><span class="line">  name: mysql</span><br><span class="line">  labels:</span><br><span class="line">    app: mysql</span><br><span class="line">spec:</span><br><span class="line">  ports:</span><br><span class="line">  - name: mysql</span><br><span class="line">    port: 3306</span><br><span class="line">  clusterIP: None</span><br><span class="line">  selector:</span><br><span class="line">    app: mysql</span><br></pre></td></tr></table></figure>
<p>如果ServiceName是mysql，则每个pod的访问地址是pod-name.mysql.default.svc.cluster.local，其中default表示默认空间</p>
<hr>
<h2 id="Node"><a href="#Node" class="headerlink" title="Node"></a>Node</h2><h3 id="label"><a href="#label" class="headerlink" title="label"></a>label</h3><h4 id="add-label"><a href="#add-label" class="headerlink" title="add label"></a>add label</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl label nodes &lt;node-name&gt; &lt;label-key&gt;=&lt;label-value&gt;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="manage"><a href="#manage" class="headerlink" title="manage"></a>manage</h3><h4 id="create-1"><a href="#create-1" class="headerlink" title="create"></a>create</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcloud container node-pools create [POOL_NAME] --zone [COMPUTE_ZONE] --cluster [CLUSTER_NAME]</span><br></pre></td></tr></table></figure>
<ul>
<li>example</li>
</ul>
<p>gcloud container node-pools create tidb-pd –zone asia-southeast1-a –cluster fintend-cloud</p>
<h4 id="view"><a href="#view" class="headerlink" title="view"></a>view</h4><hr>
<h3 id="cluster"><a href="#cluster" class="headerlink" title="cluster"></a>cluster</h3><h4 id="resizing-a-node-pool"><a href="#resizing-a-node-pool" class="headerlink" title="resizing a node pool"></a>resizing a node pool</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcloud container clusters resize [CLUSTER_NAME] --node-pool [NODE_POOL] --size [SIZE] [--zone [COMPUTE_ZONE]]</span><br></pre></td></tr></table></figure>
<ul>
<li>增加node-pool数量</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcloud container clusters resize fintend-cloud --size=5 --node-pool default-pool --zone asia-southeast1<span class="_">-a</span></span><br></pre></td></tr></table></figure>
<h4 id="add-a-new-node-pool"><a href="#add-a-new-node-pool" class="headerlink" title="add a new node-pool"></a>add a new node-pool</h4><p>查看当前可用机器配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcloud compute machine-types list</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcloud container node-pools create [POOL_NAME] --zone [COMPUTE_ZONE] --cluster [CLUSTER_NAME]</span><br></pre></td></tr></table></figure>
<p>例如，gcloud container node-pools create mq-broke-pool –zone asia-southeast1-a –cluster fintend-cloud –machine-type n1-highmem-4</p>
<p>文档链接：<a href="https://cloud.google.com/kubernetes-engine/docs/concepts/node-pools" target="_blank" rel="noopener">https://cloud.google.com/kubernetes-engine/docs/concepts/node-pools</a></p>
<hr>
<h2 id="PV"><a href="#PV" class="headerlink" title="PV"></a>PV</h2><h3 id="StorageClass"><a href="#StorageClass" class="headerlink" title="StorageClass"></a>StorageClass</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get storageclass</span><br></pre></td></tr></table></figure>
<p>输出结果<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NAME                 PROVISIONER</span><br><span class="line">pd-standard          kubernetes.io/gce-pd</span><br><span class="line">standard (default)   kubernetes.io/gce-pd</span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="Management-PV"><a href="#Management-PV" class="headerlink" title="Management PV"></a>Management PV</h3><h4 id="查看当前PV"><a href="#查看当前PV" class="headerlink" title="查看当前PV"></a>查看当前PV</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pv</span><br></pre></td></tr></table></figure>
<h4 id="删除PV"><a href="#删除PV" class="headerlink" title="删除PV"></a>删除PV</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl delete pv pv-name</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="Management-PVC"><a href="#Management-PVC" class="headerlink" title="Management PVC"></a>Management PVC</h3><h4 id="删除PVC"><a href="#删除PVC" class="headerlink" title="删除PVC"></a>删除PVC</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl delete pvc pvc-name</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/32/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/32/">32</a><span class="page-number current">33</span><a class="page-number" href="/page/34/">34</a><span class="space">&hellip;</span><a class="page-number" href="/page/52/">52</a><a class="extend next" rel="next" href="/page/34/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
          
            <img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="Jason - sulang357159@163.com">
          
            <p class="site-author-name" itemprop="name">Jason - sulang357159@163.com</p>
            <p class="site-description motion-element" itemprop="description"></p>
        </div>

        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
            
              <a href="/archives/">
            
                <span class="site-state-item-count">517</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">232</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">580</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jason - sulang357159@163.com</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动</div>

  <span class="post-meta-divider">|</span>

  <div class="theme-info">主题 &mdash; <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.2</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>


  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  








  





  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  

  

</body>
</html>
